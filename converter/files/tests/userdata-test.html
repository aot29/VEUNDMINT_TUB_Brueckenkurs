<!DOCTYPE HTML>
<html>
  <head>
    <title>Userdata API-Tests</title>
    <script type="text/javascript">
      //Global variables
      var dataserver = "http://container/mint/server";
      var isRelease = 0;
      var isVerbose = 1;
    </script>
    <script src="../qtip2/jquery-1.10.2.min.js" type="text/javascript"></script>
    <script src="../dlog.js" type="text/javascript"></script>
    <script src="../userdata.js" type="text/javascript"></script>
    <script type="text/javascript">
      function successCallback(id) {
        return function (data) {
          $('#' + id + '_result').html('<tt>' + JSON.stringify(data) + '</tt>');
        }
      }

      function errorCallback(id) {
        return function (message, data) {
          $('#' + id + '_result').html('<tt>' + message + '</tt>');
          console.log(data);
        }
      }
    </script>
  </head>
  <body>
    <b>Server-URL:</b>
    <input id='dataserver' value='http://container/mint/server' onkeyup="userdata.setURL($('#dataserver').val());">
    <h2>User Management</h2>
    <p>
      <b>Check if a user exists:</b><br/>
      Username: <input id='check_user_username'>
      <input type='button' onclick="userdata.checkUser($('#check_user_username').val(), successCallback('check_user'), errorCallback('check_user'));" value='send'>
      <div id='check_user_result'></div>
    </p>
    <p>
      <b>Add user:</b><br/><!-- TODO: wire up the role -->
      Username: <input id='add_user_username'>
      Password: <input id='add_user_password'>
      Role: <input id='add_user_role'>
      <input type='button' onclick="userdata.addUser($('#add_user_username').val(), $('#add_user_password').val(), $('#add_user_role').val(), successCallback('add_user'), errorCallback('add_user'));" value='send'>
      <div id='add_user_result'></div>
    </p>
    <b>Delete user:</b><br/>
      Username: <input id='del_user_username'>
      <input type='button' onclick="userdata.delUser($('#del_user_username').val(), successCallback('del_user'), errorCallback('del_user'))" value='delete user'>
      <div id='del_user_result'></div>
    </p>
    <p>
      <b>Change password:</b><br/>
      Username: <input id='change_pwd_username'>
      Old password: <input id='change_pwd_old_password'>
      New password: <input id='change_pwd_password'>
      <input type='button' onclick="userdata.changePwd($('#change_pwd_username').val(), $('#change_pwd_old_password').val(), $('#change_pwd_password').val(), successCallback('change_pwd'), errorCallback('change_pwd'));" value='change password'>
      <div id='change_pwd_result'></div>
    </p>
    <p>
      <b>Change role:</b><br/>
      Username: <input id='change_role_username'>
      Role: <input id='change_role_role'>
      <input type='button' onclick="userdata.changeRole($('#change_role_username').val(), $('#change_role_role').val(), successCallback('change_role'), errorCallback('change_role'));" value='change role'>
      <div id='change_role_result'></div>
    </p>

    <h2>Session Management</h2>
    <p>
      <b>Login:</b><br/>
      Username: <input id='login_username'>
      Password: <input id='login_password'>
      <input type='button' onclick="userdata.login($('#login_username').val(), $('#login_password').val(), successCallback('login'), errorCallback('login'));" value='send'>
      <div id='login_result'></div>
    </p>
    <p>
      <b>Logout:</b><br/>
      <input type='button' onclick="userdata.logout(successCallback('logout'), errorCallback('logout'));" value='logout'>
      <div id='logout_result'></div>
    </p>
    <p>
      <b>Get currently logged in user:</b><br/>
      <input type='button' onclick="userdata.getUsername(successCallback('get_username'), errorCallback('get_username'));" value='get username'>
      <div id='get_username_result'></div>
    </p>
    <b>Get role:</b><br/>
      Username: <input id='get_role_username'>
      <input type='button' onclick="userdata.getRole($('#get_role_username').val(), successCallback('get_role'), errorCallback('get_role'))" value='get role'>
      <div id='get_role_result'></div>
    </p>
    <p>

    <h2>Data</h2>
    <b>Get data:</b><br/>
      Username: <input id='get_data_username'>
      <input type='button' onclick="userdata.getData($('#get_data_username').val(), successCallback('get_data'), errorCallback('get_data'))" value='get data'>
      <div id='get_data_result'></div>
    </p>
    <b>Get login data:</b><br/>
      Username: <input id='get_login_data_username'>
      <input type='button' onclick="userdata.getLoginData($('#get_login_data_username').val(), successCallback('get_login_data'),errorCallback('get_login_data'))" value='get data'>
      <div id='get_login_data_result'></div>
    <b>Write data:</b><br/>
      Username: <input id='write_data_username'><br/>
      Data: <textarea id='write_data_data'></textarea>
      <input type='button' onclick="userdata.writeData($('#write_data_username').val(), $('#write_data_data').val(), successCallback('write_data'), errorCallback('write_data'))" value='write data'>
      <div id='write_data_result'></div>
    </p>
  </body>
</html>
