
% ENCODING: ASCII (important as must be compatible both with utf8 and latin1 based authors)
% MINTMOD Version P0.1.0, needs to be consistent with preprocesser object in tex2x and MPragma-Version at the end of this file

% Parameter aus Konvertierungsprozess (PDF und HTML-Erzeugung wenn vom Konverter aus gestartet) werden hier eingefuegt, Preambleincludes werden am Schluss angehaengt

\newif\ifttm                % gesetzt falls Uebersetzung in HTML stattfindet, sonst uebersetzung in PDF

% Wahl der Notationsvariante ist im PDF immer std, in der HTML-Uebersetzung wird vom Konverter die Auswahl modifiziert
\newif\ifvariantstd
\newif\ifvariantunotation
\variantstdtrue % this string was added by tex2x VEUNDMINT preprocessor
 % Diese Zeile wird vom Konverter erkannt und ggf. modifiziert, daher nicht veraendern!


\def\MOutputDVI{1}
\def\MOutputPDF{2}
\def\MOutputHTML{3}
\newcounter{MOutput}

\ifttm
%\usepackage{german}
\usepackage{array}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\else
\documentclass[oneside]{scrbook}
\usepackage{etex}
\usepackage[utf8]{inputenc}
\usepackage{textcomp}
\usepackage[ngerman,english]{babel}
\usepackage[pdftex]{color}
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage[all]{xy}
\usepackage{fancyhdr}
\usepackage{verbatim}
\usepackage{array}
\usepackage{float}
\usepackage{makeidx}
\usepackage{amsmath}
\usepackage{amstext}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage[ngerman,english]{varioref}
\usepackage{framed}
\usepackage{supertabular}
\usepackage{longtable}
%\usepackage{maxpage}
\usepackage{tikz}
\usepackage{tikzscale}
\usepackage{tikz-3dplot}
\usepackage{bibgerm}
\usepackage{chemarrow}
\usepackage{polynom}
%\usepackage{draftwatermark}
\usepackage{pdflscape}
\usetikzlibrary{calc}
\usetikzlibrary{through}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{arrows}
\usetikzlibrary{intersections}
\usetikzlibrary{decorations.pathmorphing}
\usetikzlibrary{external}
\usetikzlibrary{patterns}
\usetikzlibrary{fadings}
\usepackage[colorlinks=true,linkcolor=blue]{hyperref}
\usepackage[all]{hypcap}
%\usepackage[colorlinks=true,linkcolor=blue,bookmarksopen=true]{hyperref}
\usepackage{ifpdf}

\usepackage{movie15}

\setcounter{tocdepth}{2} % In Inhaltsverzeichnis bis subsection
\setcounter{secnumdepth}{3} % Nummeriert bis subsubsection

\setlength{\LTpost}{0pt} % Fuer longtable
\setlength{\parindent}{0pt}
\setlength{\parskip}{8pt}
%\setlength{\parskip}{9pt plus 2pt minus 1pt}
\setlength{\abovecaptionskip}{-0.25ex}
\setlength{\belowcaptionskip}{-0.25ex}
\fi

\ifttm
\newcommand{\MDebugMessage}[1]{\special{html:<!-- debugprint;;}#1\special{html:; //-->}}
\else
%\newcommand{\MDebugMessage}[1]{\immediate\write\mintlog{#1}}
\newcommand{\MDebugMessage}[1]{}
\fi

\def\MPageHeaderDef{%
\pagestyle{fancy}%
\fancyhead[r]{(C) VE\&MINT-Project}
\fancyfoot[c]{\thepage\\--- CCL BY-SA 3.0 ---}
}


\ifttm%
\def\MRelax{}%
\else%
\def\MRelax{\relax}%
\fi%

%--------------------------- Uebernahme von speziellen XML-Versionen einiger LaTeX-Kommandos aus xmlbefehle.tex vom alten Kasseler Konverter ---------------

\newcommand{\MSep}{\left\|{\phantom{\frac1g}}\right.}

\newcommand{\ML}{L}

\newcommand{\MGGT}{\mathrm{gcd}}

\ifttm
% Verhindert dass die subsection-nummer doppelt in der toccaption auftaucht (sollte ggf. in toccaption gefixt werden so dass diese Ueberschreibung nicht notwendig ist)
\renewcommand{\thesubsection}{}
% Kommandos die ttm nicht kennt
\newcommand{\binomial}[2]{{#1 \choose #2}} %  Binomialkoeffizienten
\newcommand{\eur}{\begin{html}&euro;\end{html}}
\newcommand{\square}{\begin{html}&square;\end{html}}
\newcommand{\glqq}{"'}  \newcommand{\grqq}{"'}
\newcommand{\nRightarrow}{\special{html: &nrArr; }}
\newcommand{\nmid}{\special{html: &nmid; }}
\newcommand{\nparallel}{\begin{html}&nparallel;\end{html}}
\newcommand{\mapstoo}{\begin{html}<mo>&map;</mo>\end{html}}

% Schnitt und Vereinigungssymbole von Mengen haben zu kleine Abstaende; korrigiert:
\newcommand{\ccup}{\,\!\cup\,\!}
\newcommand{\ccap}{\,\!\cap\,\!}


% Umsetzung von mathbb im HTML
\renewcommand{\mathbb}[1]{\begin{html}<mo>&#1opf;</mo>\end{html}}
\fi

%---------------------- Strukturierung ----------------------------------------------------------------------------------------------------------------------

%---------------------- Kapselung des sectioning findet auf drei Ebenen statt:
% 1. Die LateX-Befehl
% 2. Die D-Versionen der Befehle, die nur die Grade der Abschnitte umhaengen falls notwendig
% 3. Die M-Versionen der Befehle, die zusaetzliche Formatierungen vornehmen, Skripten starten und das HTML codieren
% Im Modultext duerfen nur die M-Befehle verwendet werden!

\ifttm

  \def\Dsubsubsubsection#1{\subsubsubsection{#1}}
  \def\Dsubsubsection#1{\subsubsection{#1}\addtocounter{subsubsection}{1}} % ttm-Fehler korrigieren
  \def\Dsubsection#1{\subsection{#1}}
  \def\Dsection#1{\section{#1}} % Im HTML wird nur der Sektionstitel gegeben
  \def\Dchapter#1{\chapter{#1}}
  \def\Dsubsubsubsectionx#1{\subsubsubsection*{#1}}
  \def\Dsubsubsectionx#1{\subsubsection*{#1}}
  \def\Dsubsectionx#1{\subsection*{#1}}
  \def\Dsectionx#1{\section*{#1}}
  \def\Dchapterx#1{\chapter*{#1}}

\else

  \def\Dsubsubsubsection#1{\subsubsection{#1}}
  \def\Dsubsubsection#1{\subsection{#1}}
  \def\Dsubsection#1{\section{#1}}
  \def\Dsection#1{\chapter{#1}}
  \def\Dchapter#1{\title{#1}}
  \def\Dsubsubsubsectionx#1{\subsubsection*{#1}}
  \def\Dsubsubsectionx#1{\subsection*{#1}}
  \def\Dsubsectionx#1{\section*{#1}}
  \def\Dsectionx#1{\chapter*{#1}}

\fi

\newcommand{\MStdPoints}{4}
\newcommand{\MSetPoints}[1]{\renewcommand{\MStdPoints}{#1}}

% Befehl zum Abbruch der Erstellung (nur PDF)
\newcommand{\MAbort}[1]{\err{#1}}

% Prefix vor Dateieinbindungen, wird in der Baumdatei mit \renewcommand modifiziert
% und auf das Verzeichnisprefix gesetzt, in dem das gerade bearbeitete tex-Dokument liegt.
% Im HTML wird es auf das Verzeichnis der HTML-Datei gesetzt.
% Das Prefix muss mit / enden !
\newcommand{\MDPrefix}{.}

% MRegisterFile notiert eine Datei zur Einbindung in den HTML-Baum. Grafiken mit MGraphics werden automatisch eingebunden.
% Mit MLastFile erhaelt man eine Markierung fuer die zuletzt registrierte Datei.
% Diese Markierung wird im postprocessing durch den physikalischen Dateinamen ersetzt, aber nur den Namen (d.h. \MMaterial gehoert noch davor, vgl Definition von MGraphics)
% Parameter: Pfad/Name der Datei bzw. des Ordners, relativ zur Position des Modul-Tex-Dokuments.
\ifttm
\newcommand{\MRegisterFile}[1]{\addtocounter{MFileNumber}{1}\special{html:<!-- registerfile;;}#1\special{html:;;}\MDPrefix\special{html:;;}\arabic{MFileNumber}\special{html:; //-->}}
\else
\newcommand{\MRegisterFile}[1]{\addtocounter{MFileNumber}{1}}
\fi

% Testen welcher Uebersetzer hier am Werk ist

\ifttm
\setcounter{MOutput}{3}
\else
\ifx\pdfoutput\undefined
  \pdffalse
  \setcounter{MOutput}{\MOutputDVI}
  \message{Verarbeitung mit latex, Ausgabe in dvi.}
\else
  \setcounter{MOutput}{\MOutputPDF}
  \message{Verarbeitung mit pdflatex, Ausgabe in pdf.}
  \ifnum \pdfoutput=0
    \pdffalse
  \setcounter{MOutput}{\MOutputDVI}
  \message{Verarbeitung mit pdflatex, Ausgabe in dvi.}
  \else
    \ifnum\pdfoutput=1
    \pdftrue
  \setcounter{MOutput}{\MOutputPDF}
  \message{Verarbeitung mit pdflatex, Ausgabe in pdf.}
    \fi
  \fi
\fi
\fi

\ifnum\value{MOutput}=\MOutputPDF
\DeclareGraphicsExtensions{.pdf,.png,.jpg}
\fi

\ifnum\value{MOutput}=\MOutputDVI
\DeclareGraphicsExtensions{.eps,.png,.jpg}
\fi

\ifnum\value{MOutput}=\MOutputHTML
% Wird vom Konverter leider nicht erkannt und daher in split.pm hardcodiert!
\DeclareGraphicsExtensions{.png,.jpg,.gif}
\fi

% Umdefinition der hyperref-Nummerierung im PDF-Modus
\ifttm
\else
\renewcommand{\theHfigure}{\arabic{chapter}.\arabic{section}.\arabic{figure}}
\fi

% Makro, um in der HTML-Ausgabe die zuerst zu oeffnende Datei zu kennzeichnen
\ifttm
\newcommand{\MGlobalStart}{\special{html:<!-- mglobalstarttag -->}}
\else
\newcommand{\MGlobalStart}{}
\fi

% Makro, um bei scormlogin ein pullen des Benutzers bei Aufruf der Seite zu erzwingen (typischerweise auf der Einstiegsseite)
\ifttm
\newcommand{\MPullSite}{\special{html:<!-- pullsite //-->}}
\else
\newcommand{\MPullSite}{}
\fi

% Makro, um in der HTML-Ausgabe die Kapiteluebersicht zu kennzeichnen
\ifttm
\newcommand{\MGlobalChapterTag}{\special{html:<!-- mglobalchaptertag -->}}
\else
\newcommand{\MGlobalChapterTag}{}
\fi

% Makro, um in der HTML-Ausgabe die Konfiguration zu kennzeichnen
\ifttm
\newcommand{\MGlobalConfTag}{\special{html:<!-- mglobalconfigtag -->}}
\else
\newcommand{\MGlobalConfTag}{}
\fi

% Makro, um in der HTML-Ausgabe die Standortbeschreibung zu kennzeichnen
\ifttm
\newcommand{\MGlobalLocationTag}{\special{html:<!-- mgloballocationtag -->}}
\else
\newcommand{\MGlobalLocationTag}{}
\fi

% Makro, um in der HTML-Ausgabe die persoenlichen Daten zu kennzeichnen
\ifttm
\newcommand{\MGlobalDataTag}{\special{html:<!-- mglobaldatatag -->}}
\else
\newcommand{\MGlobalDataTag}{}
\fi

% Makro, um in der HTML-Ausgabe die Suchseite zu kennzeichnen
\ifttm
\newcommand{\MGlobalSearchTag}{\special{html:<!-- mglobalsearchtag -->}}
\else
\newcommand{\MGlobalSearchTag}{}
\fi

% Makro, um in der HTML-Ausgabe die Favoritenseite zu kennzeichnen
\ifttm
\newcommand{\MGlobalFavoTag}{\special{html:<!-- mglobalfavoritestag -->}}
\else
\newcommand{\MGlobalFavoTag}{}
\fi

% Makro, um in der HTML-Ausgabe die Eingangstestseite zu kennzeichnen
\ifttm
\newcommand{\MGlobalSTestTag}{\special{html:<!-- mglobalstesttag -->}}
\else
\newcommand{\MGlobalSTestTag}{}
\fi

% Makro, um in der PDF-Ausgabe ein Wasserzeichen zu definieren
\ifttm
\newcommand{\MWatermarkSettings}{\relax}
\else
\newcommand{\MWatermarkSettings}{%
% \SetWatermarkText{(c) MINT-Kolleg Baden-WÃ¼rttemberg 2014}
% \SetWatermarkLightness{0.85}
% \SetWatermarkScale{1.5}
}
\fi

\ifttm
\newcommand{\MBinom}[2]{\left({\begin{array}{c} #1 \\ #2 \end{array}}\right)}
\else
\newcommand{\MBinom}[2]{\binom{#1}{#2}}
\fi

\ifttm
\newcommand{\DeclareMathOperator}[2]{\def#1{\mathrm{#2}}}
\newcommand{\operatorname}[1]{\mathrm{#1}}
\fi

%----------------- Makros fuer die gemischte HTML/PDF-Konvertierung ------------------------------

\newcommand{\MTestName}{\relax} % wird durch Test-Umgebung gesetzt

% Fuer experimentelle Kursinhalte, die im Release-Umsetzungsvorgang eine Fehlermeldung
% produzieren sollen aber sonst normal umgesetzt werden
\newenvironment{MExperimental}{%
}{%
}

% Wird von ttm nicht richtig umgesetzt!!
\newenvironment{MExerciseItems}{%
\renewcommand\theenumi{\alph{enumi}}%
\begin{enumerate}%
}{%
\end{enumerate}%
}


\definecolor{infoshadecolor}{rgb}{0.75,0.75,0.75}
\definecolor{exmpshadecolor}{rgb}{0.875,0.875,0.875}
\definecolor{expeshadecolor}{rgb}{0.95,0.95,0.95}
\definecolor{framecolor}{rgb}{0.2,0.2,0.2}

% Bei PDF-Uebersetzung wird hinter den Start jeder Satz/Info-aehnlichen Umgebung eine leere mbox gesetzt, damit
% fuehrende Listen oder enums nicht den Zeilenumbruch kaputtmachen
%\ifttm
\def\MTB{}
%\else
%\def\MTB{\mbox{}}
%\fi


\ifttm
\newcommand{\MRelates}{\special{html:<mi>&wedgeq;</mi>}}
\else
\def\MRelates{\stackrel{\scriptscriptstyle\wedge}{=}}
\fi

\def\MInch{\text{''}}
\def\Mdd{\textit{''}}

\ifttm
\def\MNL{ \newline }
\newenvironment{MArray}[1]{\begin{array}{#1}}{\end{array}}
\else
\def\MNL{ \\ }
\newenvironment{MArray}[1]{\begin{array}{#1}}{\end{array}}
\fi

\newcommand{\MBox}[1]{$\mathrm{#1}$}
\newcommand{\MMBox}[1]{\mathrm{#1}}


\ifttm%
\newcommand{\Mtfrac}[2]{{\textstyle \frac{#1}{#2}}}
\newcommand{\Mdfrac}[2]{{\displaystyle \frac{#1}{#2}}}
\newcommand{\Mmeasuredangle}{\special{html:<mi>&angmsd;</mi>}}
\else%
\newcommand{\Mtfrac}[2]{\tfrac{#1}{#2}}
\newcommand{\Mdfrac}[2]{\dfrac{#1}{#2}}
\newcommand{\Mmeasuredangle}{\measuredangle}
\relax
\fi

% Matrizen und Vektoren

% Inhalt wird in der Form a & b \\ c & d erwartet
% Vorsicht: MVector = Komponentenspalte, MVec = Variablensymbol
\ifttm%
\newcommand{\MVector}[1]{\left({\begin{array}{c}#1\end{array}}\right)}
\else%
\newcommand{\MVector}[1]{\begin{pmatrix}#1\end{pmatrix}}
\fi



\newcommand{\MVec}[1]{\vec{#1}}
\newcommand{\MDVec}[1]{\overrightarrow{#1}}

%----------------- Umgebungen fuer Definitionen und Saetze ----------------------------------------

% Fuegt einen Tabellen-Zeilenumbruch ein im PDF, aber nicht im HTML
\newcommand{\TSkip}{\ifttm \else&\ \\\fi}

\newenvironment{infoshaded}{%
\def\FrameCommand{\fboxsep=\FrameSep \fcolorbox{framecolor}{infoshadecolor}}%
\MakeFramed {\advance\hsize-\width \FrameRestore}}%
{\endMakeFramed}

\newenvironment{expeshaded}{%
\def\FrameCommand{\fboxsep=\FrameSep \fcolorbox{framecolor}{expeshadecolor}}%
\MakeFramed {\advance\hsize-\width \FrameRestore}}%
{\endMakeFramed}

\newenvironment{exmpshaded}{%
\def\FrameCommand{\fboxsep=\FrameSep \fcolorbox{framecolor}{exmpshadecolor}}%
\MakeFramed {\advance\hsize-\width \FrameRestore}}%
{\endMakeFramed}

\def\STDCOLOR{black}

\ifttm%
\else%
\newtheoremstyle{MSatzStyle}
  {1cm}                   %Space above
  {1cm}                   %Space below
  {\normalfont\itshape}   %Body font
  {}                      %Indent amount (empty = no indent,
                          %\parindent = para indent)
  {\normalfont\bfseries}  %Thm head font
  {}                      %Punctuation after thm head
  {\newline}              %Space after thm head: " " = normal interword
                          %space; \newline = linebreak
  {\thmname{#1}\thmnumber{#2}\thmnote{(#3)} }
                          %Thm head spec (can be left empty, meaning
                          %`normal')
                          %
\newtheoremstyle{MDefStyle}
  {1cm}                   %Space above
  {1cm}                   %Space below
  {\normalfont}           %Body font
  {}                      %Indent amount (empty = no indent,
                          %\parindent = para indent)
  {\normalfont\bfseries}  %Thm head font
  {}                      %Punctuation after thm head
  {\newline}              %Space after thm head: " " = normal interword
                          %space; \newline = linebreak
  {\thmname{#1}\thmnumber{#2}\thmnote{(#3)}}
                          %Thm head spec (can be left empty, meaning
                          %`normal')
\fi%

\newcommand{\MInfoText}{Info}

\newcounter{MHintCounter}
\newcounter{MCodeEditCounter}

\newcounter{MLastIndex}  % Enthaelt die dritte Stelle (Indexnummer) des letzten angelegten Objekts
\newcounter{MLastType}   % Enthaelt den Typ des letzten angelegten Objekts (mithilfe der unten definierten Konstanten). Die Entscheidung, wie der Typ dargstellt wird, wird in split.pm beim Postprocessing getroffen.
\newcounter{MLastTypeEq} % =1 falls das Label in einer Matheumgebung (equation, eqnarray usw.) steht, =2 falls das Label in einer table-Umgebung steht

% Da ttm keine Zahlmakros verarbeiten kann, werden diese Nummern in den Zuweisungen hardcodiert!
\def\MTypeSection{1}          %# Zaehler ist section
\def\MTypeSubsection{2}       %# Zaehler ist subsection
\def\MTypeSubsubsection{3}    %# Zaehler ist subsubsection
\def\MTypeInfo{4}             %# Eine Infobox, Separatzaehler fuer die Chemie (auch wenn es dort nicht nummeriert wird) ist MInfoCounter
\def\MTypeExercise{5}         %# Eine Aufgabe, Separatzaehler fuer die Chemie ist MExerciseCounter
\def\MTypeExample{6}          %# Eine Beispielbox, Separatzaehler fuer die Chemie ist MExampleCounter
\def\MTypeExperiment{7}       %# Eine Versuchsbox, Separatzaehler fuer die Chemie ist MExperimentCounter
\def\MTypeGraphics{8}         %# Eine Graphik, Separatzaehler fuer alle FB ist MGraphicsCounter
\def\MTypeTable{9}            %# Eine Tabellennummer, hat keinen Zaehler da durch table gezaehlt wird
\def\MTypeEquation{10}        %# Eine Gleichungsnummer, hat keinen Zaehler da durch equation/eqnarray gezaehlt wird
\def\MTypeTheorem{11}         % Ein theorem oder xtheorem, Separatzaehler fuer die Chemie ist MTheoremCounter
\def\MTypeVideo{12}           %# Ein Video,Separatzaehler fuer alle FB ist MVideoCounter
\def\MTypeEntry{13}           %# Ein Eintrag fuer die Stichwortliste, wird nicht gezaehlt sondern erhaelt im preparsing ein unique-label

% Zaehler fuer das Labelsystem sind prefixcounter, jeder Zaehler wird VOR dem gezaehlten Objekt inkrementiert und zaehlt daher das aktuelle Objekt
\newcounter{MInfoCounter}
\newcounter{MExerciseCounter}
\newcounter{MExampleCounter}
\newcounter{MExperimentCounter}
\newcounter{MGraphicsCounter}
\newcounter{MTableCounter}
\newcounter{MEquationCounter}  % Nur im HTML, sonst durch "equation"-counter von latex realisiert
\newcounter{MTheoremCounter}
\newcounter{MObjectCounter}   % Gemeinsamer Zaehler fuer Objekte (ausser Grafiken/Tabellen) in Mathe/Info/Physik
\newcounter{MVideoCounter}
\newcounter{MEntryCounter}

\newcounter{MTestSite} % 1 = Subsubsection ist eine Pruefungsseite, 0 = ist eine normale Seite (inkl. Hilfeseite)

\def\MCell{$\phantom{a}$}

\newenvironment{MExportExercise}{\begin{MExercise}}{\end{MExercise}} % wird von mconvert abgefangen

\def\MGenerateExNumber{%
\ifnum\value{MSepNumbers}=0%
\arabic{section}.\arabic{subsection}.\arabic{MObjectCounter}\setcounter{MLastIndex}{\value{MObjectCounter}}%
\else%
\arabic{section}.\arabic{subsection}.\arabic{MExerciseCounter}\setcounter{MLastIndex}{\value{MExerciseCounter}}%
\fi%
}%

\def\MGenerateExmpNumber{%
\ifnum\value{MSepNumbers}=0%
\arabic{section}.\arabic{subsection}.\arabic{MObjectCounter}\setcounter{MLastIndex}{\value{MObjectCounter}}%
\else%
\arabic{section}.\arabic{subsection}.\arabic{MExerciseCounter}\setcounter{MLastIndex}{\value{MExampleCounter}}%
\fi%
}%

\def\MGenerateInfoNumber{%
\ifnum\value{MSepNumbers}=0%
\arabic{section}.\arabic{subsection}.\arabic{MObjectCounter}\setcounter{MLastIndex}{\value{MObjectCounter}}%
\else%
\arabic{section}.\arabic{subsection}.\arabic{MExerciseCounter}\setcounter{MLastIndex}{\value{MInfoCounter}}%
\fi%
}%

\def\MGenerateSiteNumber{%
\arabic{section}.\arabic{subsection}.\arabic{subsubsection}%
}%

% Funktionalitaet fuer Auswahlaufgaben

\newcounter{MExerciseCollectionCounter} % = 0 falls nicht in collection-Umgebung, ansonsten Schachtelungstiefe
\newcounter{MExerciseCollectionTextCounter} % wird von MExercise-Umgebung inkrementiert und von MExerciseCollection-Umgebung auf Null gesetzt

\ifttm
% MExerciseCollection gruppiert Aufgaben, die dynamisch aus der Datenbank gezogen werden und nicht direkt in der HTML-Seite stehen
% Parameter: #1 = ID der Collection, muss eindeutig fuer alle IN DER DB VORHANDENEN collections sein unabhaengig vom Kurs
%            #2 = Optionsargument (im Moment: 1 = Iterative Auswahl, 2 = Zufallsbasierte Auswahl)
\newenvironment{MExerciseCollection}[2]{%
\addtocounter{MExerciseCollectionCounter}{1}
\setcounter{MExerciseCollectionTextCounter}{0}
\special{html:<!-- mexercisecollectionstart;;}#1\special{html:;;}#2\special{html:;; //-->}%
}{%
\special{html:<!-- mexercisecollectionstop //-->}%
\addtocounter{MExerciseCollectionCounter}{-1}
}
\else
\newenvironment{MExerciseCollection}[2]{%
\addtocounter{MExerciseCollectionCounter}{1}
\setcounter{MExerciseCollectionTextCounter}{0}
}{%
\addtocounter{MExerciseCollectionCounter}{-1}
}
\fi

% Bei Uebersetzung nach PDF werden die theorem-Umgebungen verwendet, bei Uebersetzung in HTML ein manuelles Makro
\ifttm%

  \newenvironment{MHint}[1]{  \special{html:<button name="Name_MHint}\arabic{MHintCounter}\special{html:" class="hintbutton_closed btn btn-default" id="MHint}\arabic{MHintCounter}\special{html:_button" %
  type="button" onclick="toggle_hint('MHint}\arabic{MHintCounter}\special{html:');">}#1\special{html:</button>}
  \special{html:<div class="hint well" style="display:none" id="MHint}\arabic{MHintCounter}\special{html:"> }}{\begin{html}</div>\end{html}\addtocounter{MHintCounter}{1}}

  \newenvironment{MCOSHZusatz}{  \special{html:<button name="Name_MHint}\arabic{MHintCounter}\special{html:" class="chintbutton_closed" id="MHint}\arabic{MHintCounter}\special{html:_button" %
  type="button" onclick="toggle_hint('MHint}\arabic{MHintCounter}\special{html:');">}\iCoshAdd{}\special{html:</button>}
  \special{html:<div class="hintc" style="display:none" id="MHint}\arabic{MHintCounter}\special{html:">
  <div class="coshwarn">}\iCoshWarn{}\special{html:</div><br />}
  \addtocounter{MHintCounter}{1}}{\begin{html}</div>\end{html}}


  \newenvironment{MDefinition}{\begin{definition}\setcounter{MLastIndex}{\value{definition}}\ \\}{\end{definition}}


  \newenvironment{MExercise}{
  \renewcommand{\MStdPoints}{4}
  \addtocounter{MExerciseCounter}{1}
  \addtocounter{MObjectCounter}{1}
  \setcounter{MLastType}{5}

\ifnum\value{MExerciseCollectionCounter}=0\else\addtocounter{MExerciseCollectionTextCounter}{1}\special{html:<!-- mexercisetextstart;;}\arabic{MExerciseCollectionTextCounter}\special{html:;; //-->}\fi
  \special{html:<div class="aufgabe"
  id="ADIV_}\MGenerateExNumber\special{html:"><div class="panel
  panel-warning"><div class="panel-heading"><h5 class="title">}%
  \textbf{\iExercise{} \MGenerateExNumber
  } \begin{html}</h5></div><div class="panel-body">\end{html}}{\special{html:</div></div></div><!--
  mfeedbackbutton;Exercise;}\arabic{MTestSite}\special{html:;}\MGenerateExNumber\special{html:; //-->} \ifnum\value{MExerciseCollectionCounter}=0\else\special{html:<!-- mexercisetextstop //-->}\fi
  }
  % Stellt eine Kombination aus Aufgabe, Loesungstext und Eingabefeld bereit,
  % bei der Aufgabentext und Musterloesung sowie die zugehoerigen Feldelemente
  % extern bezogen und div-aktualisiert werden, das Eingabefeld aber immer das gleiche ist.
  \newenvironment{MFetchExercise}{
  \addtocounter{MExerciseCounter}{1}
  \addtocounter{MObjectCounter}{1}
  \setcounter{MLastType}{5}

  \special{html:<div class="aufgabe" id="ADIV_}\MGenerateExNumber\special{html:">}%
  \textbf{\iExercise{} \MGenerateExNumber
  } \ \\%
  \special{html:</div><div class="exfetch_text" id="ADIVTEXT_}\MGenerateExNumber\special{html:">}%
  \special{html:</div><div class="exfetch_sol" id="ADIVSOL_}\MGenerateExNumber\special{html:">}%
  \special{html:</div><div class="exfetch_input" id="ADIVINPUT_}\MGenerateExNumber\special{html:">}%
  }{
  \special{html:</div>}
  }

  \newenvironment{MExample}{
  \addtocounter{MExampleCounter}{1}
  \addtocounter{MObjectCounter}{1}
  \setcounter{MLastType}{6}
  \begin{html}
  <div class="exmp">
  <div class="exmprahmen panel panel-default">
  <div class="panel-heading"><h5 class="panel-title">
  \end{html}\textbf{\iExample{}
  \ifnum\value{MSepNumbers}=0
  \arabic{section}.\arabic{subsection}.\arabic{MObjectCounter}\setcounter{MLastIndex}{\value{MObjectCounter}}
  \else
  \arabic{section}.\arabic{subsection}.\arabic{MExampleCounter}\setcounter{MLastIndex}{\value{MExampleCounter}}
  \fi
  } \begin{html}</h5></div><div class="panel-body">\end{html}}
  {\begin{html}</div></div></div>\end{html}
  \special{html:<!-- mfeedbackbutton;Example;}\arabic{MTestSite}\special{html:;}\MGenerateExmpNumber\special{html:; //-->}
  }

  \newenvironment{MExperiment}{
  \addtocounter{MExperimentCounter}{1}
  \addtocounter{MObjectCounter}{1}
  \setcounter{MLastType}{7}
  \begin{html}
  <div class="expe">
  <div class="experahmen">
  \end{html}\textbf{\iExperiment{}
  \ifnum\value{MSepNumbers}=0
  \arabic{section}.\arabic{subsection}.\arabic{MObjectCounter}\setcounter{MLastIndex}{\value{MObjectCounter}}
  \else
%  \arabic{MExperimentCounter}\setcounter{MLastIndex}{\value{MExperimentCounter}}
  \arabic{section}.\arabic{subsection}.\arabic{MExperimentCounter}\setcounter{MLastIndex}{\value{MExperimentCounter}}
  \fi
  } \ \\}{\begin{html}</div>
  </div>
  \end{html}}

  \newenvironment{MChemInfo}{
  \setcounter{MLastType}{4}
  \begin{html}
  <div class="info">
  <div class="inforahmen">
  \end{html}}{\begin{html}</div>
  </div>
  \end{html}}

  \newenvironment{MXInfo}[1]{
  \addtocounter{MInfoCounter}{1}
  \addtocounter{MObjectCounter}{1}
  \setcounter{MLastType}{4}
  \begin{html}
  <div class="info">
  <div class="inforahmen panel panel-info">
  <div class="panel-heading"><h5 class="panel-title">
  \end{html}\textbf{#1
  \ifnum\value{MInfoNumbers}=0
  \else
    \ifnum\value{MSepNumbers}=0
    \arabic{section}.\arabic{subsection}.\arabic{MObjectCounter}\setcounter{MLastIndex}{\value{MObjectCounter}}
    \else
    \arabic{MInfoCounter}\setcounter{MLastIndex}{\value{MInfoCounter}}
    \fi
  \fi
  } \begin{html}</h5></div><div class="panel-body">\end{html}}
  {\begin{html}</div></div></div>\end{html}
  \special{html:<!-- mfeedbackbutton;Info;}\arabic{MTestSite}\special{html:;}\MGenerateInfoNumber\special{html:; //-->}
  }

  \newenvironment{MInfo}
  {\ifnum\value{MInfoNumbers}=0\begin{MChemInfo}\else\begin{MXInfo}{Info}\ \\ \fi}
  {\ifnum\value{MInfoNumbers}=0\end{MChemInfo}\else\end{MXInfo}\fi}

\else%

  \theoremstyle{MSatzStyle}
  \newtheorem{thm}{Satz}[section]
  \newtheorem{thmc}{Satz}
  \theoremstyle{MDefStyle}
  \newtheorem{defn}[thm]{Definition}
  \newtheorem{exmp}[thm]{\iExample{} }
  \newtheorem{info}[thm]{\MInfoText}
  \theoremstyle{MDefStyle}
  \newtheorem{defnc}{Definition}
  \theoremstyle{MDefStyle}
  \newtheorem{exmpc}{\iExample{} } [section]
  \theoremstyle{MDefStyle}
  \newtheorem{infoc}{\MInfoText}
  \theoremstyle{MDefStyle}
  \newtheorem{exrc}{\iExercise{} } [section]
  \theoremstyle{MDefStyle}
  \newtheorem{verc}{Versuch} [section]

  \newenvironment{MFetchExercise}{}{} % kann im PDF nicht dargestellt werden

  \newenvironment{MExercise}{\begin{exrc}\renewcommand{\MStdPoints}{1}\MTB}{\end{exrc}}
  \newenvironment{MHint}[1]{\ \\ \underline{#1:}\\}{}
  \newenvironment{MCOSHZusatz}{\ \\ \underline{\iCoshAdd{}:}\\}{}
%  \newenvironment{MDefinition}{\ifnum\value{MInfoNumbers}=0\begin{defnc}\else\begin{defn}\fi\MTB}{\ifnum\value{MInfoNumbers}=0\end{defnc}\else\end{defn}\fi}
%  \newenvironment{MExample}{\begin{exmp}}{\ \linebreak[1] \ \ \ \ $\phantom{a}$ \ \hfill $\blacklozenge$\end{exmp}}
  \newenvironment{MExample}{
    \ifnum\value{MInfoNumbers}=0\begin{exmpc}\else\begin{exmp}\fi
    \MTB
    \begin{exmpshaded}
    \ \newline
}{
    \end{exmpshaded}
    \ifnum\value{MInfoNumbers}=0\end{exmpc}\else\end{exmp}\fi
}
  \newenvironment{MChemInfo}{\begin{infoshaded}}{\end{infoshaded}}
%  \newenvironment{MXInfo}{\begin{infoshaded}}{\end{infoshaded}}

  \newenvironment{MInfo}{\ifnum\value{MInfoNumbers}=0\begin{MChemInfo}\else\renewcommand{\MInfoText}{Info}\begin{info}\begin{infoshaded}
  \MTB
   \ \newline
    \fi
  }{\ifnum\value{MInfoNumbers}=0\end{MChemInfo}\else\end{infoshaded}\end{info}\fi}

  \newenvironment{MXInfo}[1]{
    \renewcommand{\MInfoText}{#1}
    \ifnum\value{MInfoNumbers}=0\begin{infoc}\else\begin{info}\fi%
    \MTB
    \begin{infoshaded}
    \ \newline
  }{\end{infoshaded}\ifnum\value{MInfoNumbers}=0\end{infoc}\else\end{info}\fi}

  \newenvironment{MExperiment}{
    \renewcommand{\MInfoText}{\iExperiment{}}
    \ifnum\value{MInfoNumbers}=0\begin{verc}\else\begin{info}\fi
    \MTB
    \begin{expeshaded}
    \ \newline
  }{
    \end{expeshaded}
    \ifnum\value{MInfoNumbers}=0\end{verc}\else\end{info}\fi
  }
\fi%

% MHint sollte nicht direkt fuer Loesungen benutzt werden wegen solutionselect
\newenvironment{MSolution}{\begin{MHint}{Solution}}{\end{MHint}}

\newcounter{MCodeCounter}

\ifttm
\newenvironment{MCode}{\special{html:<!-- mcodestart -->}\ttfamily\color{blue}}{\special{html:<!-- mcodestop -->}}
\else
\newenvironment{MCode}{\begin{flushleft}\ttfamily\addtocounter{MCodeCounter}{1}}{\addtocounter{MCodeCounter}{-1}\end{flushleft}}
% Ohne color-Statement da inkompatible mit framed/shaded-Boxen aus dem framed-package
\fi

%----------------- Sonderdefinitionen fuer Symbole, die der Konverter nicht kann ----------------------------------------------

\ifttm%
\newcommand{\MUnderset}[2]{\underbrace{#2}_{#1}}%
\else%
\newcommand{\MUnderset}[2]{\underset{#1}{#2}}%
\fi%

\ifttm
\newcommand{\MThinspace}{\special{html:<mi>&#x2009;</mi>}}
\else
\newcommand{\MThinspace}{\,}
\fi

\ifttm
\newcommand{\glq}{\begin{html}&sbquo;\end{html}}
\newcommand{\grq}{\begin{html}&lsquo;\end{html}}
\newcommand{\glqq}{\begin{html}&bdquo;\end{html}}
\newcommand{\grqq}{\begin{html}&ldquo;\end{html}}
\fi

% Backsim (PhysikBK)
\ifttm
\newcommand{\backsim}{\begin{html}<mi>&backsim;</mi>\end{html}}
\fi
% Cancel (PhysikBK)
\ifttm
\newcommand{\cancel}[1]{\begin{html}<menclose notation="horizontalstrike"><mi>#1</mi></menclose>\end{html}}
\fi


\ifttm
\newcommand{\MNdash}{\begin{html}&ndash;\end{html}}
\else
\newcommand{\MNdash}{--}
\fi

%\ifttm\def\MIU{\special{html:<mi>&#8520;</mi>}}\else\def\MIU{\mathrm{i}}\fi
\def\MIU{\mathrm{i}}
\def\MEU{e} % TU9-Onlinekurs: italic-e
%\def\MEU{\mathrm{e}} % Alte Onlinemodule: roman-e
\def\MD{d} % Kursives d in Integralen im TU9-Onlinekurs
%\def\MD{\mathrm{d}} % roman-d in den alten Onlinemodulen
\def\MDB{\|}

%zusaetzlicher Leerraum vor "\MD"
\ifttm%
\def\MDSpace{\special{html:<mi>&#x2009;</mi>}}
\else%
\def\MDSpace{\,}
\fi%
\newcommand{\MDwSp}{\MDSpace\MD}%

\ifttm
\def\Mdq{\dq}
\else
\def\Mdq{\dq}
\fi

\def\MSpan#1{\left<{#1}\right>}
\def\MSetminus{\setminus}
\def\MIM{I}

\ifttm
\newcommand{\ld}{\text{ld}}
\newcommand{\lg}{\text{lg}}
\else
\DeclareMathOperator{\ld}{ld}
%\newcommand{\lg}{\text{lg}} % in latex schon definiert
\fi


\def\Mmapsto{\ifttm\special{html:<mi>&mapsto;</mi>}\else\mapsto\fi}
\def\Mvarphi{\ifttm\phi\else\varphi\fi}
\def\Mphi{\ifttm\varphi\else\phi\fi}
\ifttm%
\newcommand{\MEumu}{\special{html:<mi>&#x3BC;</mi>}}%
\else%
\newcommand{\MEumu}{\textrm{\textmu}}%
\fi
\def\Mvarepsilon{\ifttm\epsilon\else\varepsilon\fi}
\def\Mepsilon{\ifttm\varepsilon\else\epsilon\fi}
\def\Mvarkappa{\ifttm\kappa\else\varkappa\fi}
\def\Mkappa{\ifttm\varkappa\else\kappa\fi}
\def\Mcomplement{\ifttm\special{html:<mi>&comp;</mi>}\else\complement\fi}
\def\MWW{\mathrm{WW}}
\def\Mmod{\ifttm\special{html:<mi>&nbsp;mod&nbsp;</mi>}\else\mod\fi}

\ifttm%
\def\mod{\text{\;mod\;}}%
\def\MNEquiv{\special{html:<mi>&NotCongruent;</mi>}}%
\def\MNSubseteq{\special{html:<mi>&NotSubsetEqual;</mi>}}%
\def\MEmptyset{\special{html:<mi>&empty;</mi>}}%
\def\MVDots{\special{html:<mi>&#x22EE;</mi>}}%
\def\MHDots{\special{html:<mi>&#x2026;</mi>}}%
\def\Mddag{\special{html:<mi>&#x1202;</mi>}}%
\def\sphericalangle{\special{html:<mi>&measuredangle;</mi>}}%
\def\nparallel{\special{html:<mi>&nparallel;</mi>}}%
\def\MProofEnd{\special{html:<mi>&#x25FB;</mi>}}%
\newenvironment{MProof}[1]{\underline{#1}:\MCR\MCR}{\hfill $\MProofEnd$}%
\else%
\def\MNEquiv{\not\equiv}%
\def\MNSubseteq{\not\subseteq}%
\def\MEmptyset{\emptyset}%
\def\MVDots{\vdots}%
\def\MHDots{\hdots}%
\def\Mddag{\ddag}%
\newenvironment{MProof}[1]{\begin{proof}[#1]}{\end{proof}}%
\fi%



% Spaces zum Auffuellen von Tabellenbreiten, die nur im HTML wirken
\ifttm%
\def\MTSP{\:}%
\else%
\def\MTSP{}%
\fi%

\DeclareMathOperator{\arsinh}{arsinh}
\DeclareMathOperator{\arcosh}{arcosh}
\DeclareMathOperator{\artanh}{artanh}
\DeclareMathOperator{\arcoth}{arcoth}


\newcommand{\MMathSet}[1]{\mathbb{#1}}
\def\N{\MMathSet{N}}
\def\Z{\MMathSet{Z}}
\def\Q{\MMathSet{Q}}
\def\R{\MMathSet{R}}
\def\C{\MMathSet{C}}

\newcounter{MForLoopCounter}
\newcommand{\MForLoop}[2]{\setcounter{MForLoopCounter}{#1}\ifnum\value{MForLoopCounter}=0{}\else{{#2}\addtocounter{MForLoopCounter}{-1}\MForLoop{\value{MForLoopCounter}}{#2}}\fi}

\newcounter{MSiteCounter}
\newcounter{MFieldCounter} % Kombination section.subsection.site.field ist eindeutig in allen Modulen, field alleine nicht

\newcounter{MiniMarkerCounter}

\ifttm
\newenvironment{MMiniPageP}[1]{\begin{minipage}{#1\linewidth}\special{html:<!-- minimarker;;}\arabic{MiniMarkerCounter}\special{html:;;#1; //-->}}{\end{minipage}\addtocounter{MiniMarkerCounter}{1}}
\else
\newenvironment{MMiniPageP}[1]{\begin{minipage}{#1\linewidth}}{\end{minipage}\addtocounter{MiniMarkerCounter}{1}}
\fi

\newcounter{AlignCounter}

\newcommand{\MStartJustify}{\ifttm\special{html:<!-- startalign;;}\arabic{AlignCounter}\special{html:;;justify; //-->}\fi}
\newcommand{\MStopJustify}{\ifttm\special{html:<!-- stopalign;;}\arabic{AlignCounter}\special{html:; //-->}\fi\addtocounter{AlignCounter}{1}}

\newenvironment{MJTabular}[1]{
\MStartJustify
\begin{tabular}{#1}
}{
\end{tabular}
\MStopJustify
}

\newcommand{\MImageLeft}[2]{
\begin{center}
\begin{tabular}{lc}
\MStartJustify
\begin{MMiniPageP}{0.65}
#1
\end{MMiniPageP}
\MStopJustify
&
\begin{MMiniPageP}{0.3}
#2
\end{MMiniPageP}
\end{tabular}
\end{center}
}

\newcommand{\MImageHalf}[2]{
\begin{center}
\begin{tabular}{lc}
\MStartJustify
\begin{MMiniPageP}{0.45}
#1
\end{MMiniPageP}
\MStopJustify
&
\begin{MMiniPageP}{0.45}
#2
\end{MMiniPageP}
\end{tabular}
\end{center}
}

\newcommand{\MBigImageLeft}[2]{
\begin{center}
\begin{tabular}{lc}
\MStartJustify
\begin{MMiniPageP}{0.25}
#1
\end{MMiniPageP}
\MStopJustify
&
\begin{MMiniPageP}{0.7}
#2
\end{MMiniPageP}
\end{tabular}
\end{center}
}

\ifttm
\def\No{\mathbb{N}_0}
\else
\def\No{\ensuremath{\N_0}}
\fi
\def\MT{\textrm{\tiny T}}
\newcommand{\MTranspose}[1]{{#1}^{\MT}}
\ifttm
\newcommand{\MRe}{\mathsf{Re}}
\newcommand{\MIm}{\mathsf{Im}}
\else
\DeclareMathOperator{\MRe}{Re}
\DeclareMathOperator{\MIm}{Im}
\fi

\newcommand{\Mid}{\mathrm{id}}
\newcommand{\MFeinheit}{\mathrm{feinh}}

\ifttm
\newcommand{\Msubstack}[1]{\begin{array}{c}{#1}\end{array}}
\else
\newcommand{\Msubstack}[1]{\substack{#1}}
\fi

% Typen von Fragefeldern:
% 1 = Alphanumerisch, case-sensitive-Vergleich
% 2 = Ja/Nein-Checkbox, Loesung ist 0 oder 1   (OPTION = Image-id fuer Rueckmeldung)
% 3 = Reelle Zahlen Geparset
% 4 = Funktionen Geparset (mit Stuetzstellen zur ueberpruefung)

% Dieser Befehl erstellt ein interaktives Aufgabenfeld. Parameter:
% - #1 Laenge in Zeichen
% - #2 Loesungstext (alphanumerisch, case sensitive)
% - #3 AufgabenID (alphanumerisch, case sensitive)
% - #4 Typ (Kennnummer)
% - #5 String fuer Optionen (ggf. mit Semikolon getrennte Einzelstrings)
% - #6 Anzahl Punkte
% - #7 uxid (kann z.B. Loesungsstring sein)
% ACHTUNG: Die langen Zeilen bitte so lassen, Zeilenumbrueche im tex werden in div's umgesetzt
\ifttm
\newcommand{\MQuestionID}[7]{
\special{html:<!-- mdeclareuxid;;}UX#7\special{html:;;}\arabic{section}\special{html:;;}#3\special{html:;; //-->}%
\special{html:<!-- mdeclarepoints;;}\arabic{section}\special{html:;;}#3\special{html:;;}#6\special{html:;;}\arabic{MTestSite}\special{html:;;}\arabic{chapter}%
\special{html:;; //--><!-- onloadstart //-->CreateQuestionObj("}#7\special{html:",}\arabic{MFieldCounter}\special{html:,"}#2%
\special{html:","}#3\special{html:",}#4\special{html:,"}#5\special{html:",}#6\special{html:,}\arabic{MTestSite}\special{html:,}\arabic{section}%
\special{html:);<!-- onloadstop //-->}%
\special{html:<input mfieldtype="}#4\special{html:" name="Name_}#3\special{html:" id="}#3\special{html:" type="text" size="}#1\special{html:" maxlength="}#1%
\special{html:" }
\ifnum\value{MGroupActive}=0\special{html:onfocus="handlerFocus(}\arabic{MFieldCounter}\special{html:);" onblur="handlerBlur(}\arabic{MFieldCounter}\special{html:);" onkeyup="handlerChange(}\arabic{MFieldCounter}\special{html:,0);" onpaste="handlerChange(}\arabic{MFieldCounter}\special{html:,0);" oninput="handlerChange(}\arabic{MFieldCounter}\special{html:,0);" onpropertychange="handlerChange(}\arabic{MFieldCounter}\special{html:,0);"/>}%
\special{html:<span><span class="glyphicon glyphicon-question-sign" id="}QM#3\special{html:"/></span>} % needs to be nested spans here, as they get garbled-up somehow
\else%
\special{html:onblur="handlerBlur(}\arabic{MFieldCounter}%
\special{html:);" onfocus="handlerFocus(}\arabic{MFieldCounter}\special{html:);" onkeyup="handlerChange(}\arabic{MFieldCounter}\special{html:,1);" onpaste="handlerChange(}\arabic{MFieldCounter}\special{html:,1);" oninput="handlerChange(}\arabic{MFieldCounter}\special{html:,1);" onpropertychange="handlerChange(}\arabic{MFieldCounter}\special{html:,1);"/>}%
\special{html:<span><span class="glyphicon glyphicon-question-sign" id="}QM#3\special{html:"/></span>} % needs to be nested spans here, as they get garbled-up somehow
\fi
}
\else
\newcommand{\MQuestionID}[7]{
\ifnum\value{QBoxFlag}=1\fbox{$\phantom{\MForLoop{#1}{b}}$}
\else
$\phantom{\MForLoop{#1}{b}}$
\fi%
}
\fi%

% ACHTUNG: Die langen Zeilen bitte so lassen, Zeilenumbrueche im tex werden in div's umgesetzt
% QuestionCheckbox macht ausserhalb einer QuestionGroup keinen Sinn!
% #1 = solution (1 oder 0), ggf. mit ::smc abgetrennt auszuschliessende single-choice-boxen (UXIDs durch , getrennt), #2 = id, #3 = points, #4 = uxid
\ifttm
\newcommand{\MQuestionCheckbox}[4]{
\special{html:<!-- mdeclareuxid;;}UX#4\special{html:;;}\arabic{section}\special{html:;;}#2\special{html:;; //-->}%
\ifnum\value{MGroupActive}=0\MDebugMessage{ERROR: Checkbox Nr. \arabic{MFieldCounter}\ ist nicht in einer Kontrollgruppe, es wird niemals eine Loesung angezeigt!}\fi
\special{html: %
<!-- mdeclarepoints;;}\arabic{section}\special{html:;;}#2\special{html:;;}#3\special{html:;;}\arabic{MTestSite}\special{html:;;}\arabic{chapter}%
\special{html:;; //--><!-- onloadstart //-->CreateQuestionObj("}#4\special{html:",}\arabic{MFieldCounter}\special{html:,"}#1\special{html:","}#2\special{html:",2,"IMG}#2%
\special{html:",}#3\special{html:,}\arabic{MTestSite}\special{html:,}\arabic{section}\special{html:);<!-- onloadstop //-->}%
\special{html:<input mtristate="1" cval="0" mfieldtype="2" type="checkbox" name="Name_}#2\special{html:" id="}#2\special{html:" onchange="handlerChange(}\arabic{MFieldCounter}\special{html:,1);"/>}
\special{html:<span><span class="glyphicon glyphicon-question-sign" id="}IMG#2\special{html:"/></span>} % needs to be nested spans here, as they get garbled-up somehow
}
\else%
\newcommand{\MQuestionCheckbox}[4]{
\ifnum\value{QBoxFlag}=1\fbox{$\phantom{X}$}\else$\phantom{X}$\fi%
}
\fi%

\def\MGenerateID{QFELD_\arabic{section}.\arabic{subsection}.\arabic{MSiteCounter}.QF\arabic{MFieldCounter}}

% #1 = 0/1 ggf. mit ::smc abgetrennt auszuschliessende single-choice-boxen (UXIDs durch , getrennt ohne UX), #2 = uxid ohne UX
\newcommand{\MCheckbox}[2]{
\MQuestionCheckbox{#1}{\MGenerateID}{\MStdPoints}{#2}
\addtocounter{MFieldCounter}{1}
}

% #1 = 0/1 ggf. mit ::smc abgetrennt auszuschliessende single-choice-boxen (UXIDs durch , getrennt ohne UX), #2 = uxid ohne UX
\newcommand{\MLCheckbox}[2]{
\MQuestionCheckbox{#1}{\MGenerateID}{\MStdPoints}{#2}
\addtocounter{MFieldCounter}{1}
}

% Erster Parameter: Zeichenlaenge der Eingabebox, zweiter Parameter: Loesungstext
\newcommand{\MQuestion}[2]{
\MQuestionID{#1}{#2}{\MGenerateID}{1}{0}{\MStdPoints}{#2}
\addtocounter{MFieldCounter}{1}
}

% Erster Parameter: Zeichenlaenge der Eingabebox, zweiter Parameter: Loesungstext
\newcommand{\MLQuestion}[3]{
\MQuestionID{#1}{#2}{\MGenerateID}{1}{0}{\MStdPoints}{#3}
\addtocounter{MFieldCounter}{1}
}

% Parameter: Laenge des Feldes, Loesung (wird auch geparsed), Stellen Genauigkeit hinter dem Komma, weitere Stellen werden mathematisch gerundet vor Vergleich
\newcommand{\MParsedQuestion}[3]{
\MQuestionID{#1}{#2}{\MGenerateID}{3}{#3}{\MStdPoints}{#2}
\addtocounter{MFieldCounter}{1}
}

% Parameter: Laenge des Feldes, Loesung (wird auch geparsed), Stellen Genauigkeit hinter dem Komma, weitere Stellen werden mathematisch gerundet vor Vergleich
\newcommand{\MLParsedQuestion}[4]{
\MQuestionID{#1}{#2}{\MGenerateID}{3}{#3}{\MStdPoints}{#4}
\addtocounter{MFieldCounter}{1}
}

% Parameter: Laenge des Feldes, Loesungsfunktion, Anzahl Stuetzstellen, Funktionsvariablen durch Kommata getrennt (nicht case-sensitive), Anzahl Nachkommastellen im Vergleich
\newcommand{\MFunctionQuestion}[5]{
\MQuestionID{#1}{#2}{\MGenerateID}{4}{#3;#4;#5;0}{\MStdPoints}{#2}
\addtocounter{MFieldCounter}{1}
}

% Parameter: Laenge des Feldes, Loesungsfunktion, Anzahl Stuetzstellen, Funktionsvariablen durch Kommata getrennt (nicht case-sensitive), Anzahl Nachkommastellen im Vergleich, UXID
\newcommand{\MLFunctionQuestion}[6]{
\MQuestionID{#1}{#2}{\MGenerateID}{4}{#3;#4;#5;0}{\MStdPoints}{#6}
\addtocounter{MFieldCounter}{1}
}

% Parameter: Laenge des Feldes, Loesungsintervall, Genauigkeit der Zahlenwertpruefung
\newcommand{\MIntervalQuestion}[3]{
\MQuestionID{#1}{#2}{\MGenerateID}{6}{#3}{\MStdPoints}{#2}
\addtocounter{MFieldCounter}{1}
}

% Parameter: Laenge des Feldes, Loesungsintervall, Genauigkeit der Zahlenwertpruefung, UXID
\newcommand{\MLIntervalQuestion}[4]{
\MQuestionID{#1}{#2}{\MGenerateID}{6}{#3}{\MStdPoints}{#4}
\addtocounter{MFieldCounter}{1}
}

% Parameter: Laenge des Feldes, Loesungsfunktion, Anzahl Stuetzstellen, Funktionsvariable (nicht case-sensitive), Anzahl Nachkommastellen im Vergleich, Vereinfachungsbedingung
% Vereinfachungsbedingung ist eine der Folgenden:
% 0 = Keine Vereinfachungsbedingung
% 1 = Keine Klammern (runde oder eckige) mehr im vereinfachten Ausdruck
% 2 = Faktordarstellung (Term hat Produkte als letzte Operation, Summen als vorgeschaltete Operation)
% 3 = Summendarstellung (Term hat Summen als letzte Operation, Produkte als vorgeschaltete Operation)
% Flag 512: Besondere Stuetzstellen (nur >1 und nur schwach rational), sonst symmetrisch um Nullpunkt und ganze Zahlen inkl. Null werden getroffen
\newcommand{\MSimplifyQuestion}[6]{
\MQuestionID{#1}{#2}{\MGenerateID}{4}{#3;#4;#5;#6}{\MStdPoints}{#2}
\addtocounter{MFieldCounter}{1}
}

\newcommand{\MLSimplifyQuestion}[7]{
\MQuestionID{#1}{#2}{\MGenerateID}{4}{#3;#4;#5;#6}{\MStdPoints}{#7}
\addtocounter{MFieldCounter}{1}
}

% Parameter: Laenge des Feldes, Loesung (optionaler Ausdruck), Anzahl Stuetzstellen, Funktionsvariable (nicht case-sensitive), Anzahl Nachkommastellen im Vergleich, Spezialtyp (string-id)
\newcommand{\MLSpecialQuestion}[7]{
\MQuestionID{#1}{#2}{\MGenerateID}{7}{#3;#4;#5;#6}{\MStdPoints}{#7}
\addtocounter{MFieldCounter}{1}
}

\newcounter{MGroupStart}
\newcounter{MGroupEnd}
\newcounter{MGroupActive}

\newenvironment{MQuestionGroup}{
\setcounter{MGroupStart}{\value{MFieldCounter}}
\setcounter{MGroupActive}{1}
}{
\setcounter{MGroupActive}{0}
\setcounter{MGroupEnd}{\value{MFieldCounter}}
\addtocounter{MGroupEnd}{-1}
}

\newcommand{\MGroupButton}[1]{
\ifttm
\special{html:<button name="Name_Group}\arabic{MGroupStart}\special{html:to}\arabic{MGroupEnd}\special{html:" class="groupbutton" id="Group}\arabic{MGroupStart}\special{html:to}\arabic{MGroupEnd}\special{html:" %
type="button" onclick="group_button(}\arabic{MGroupStart}\special{html:,}\arabic{MGroupEnd}\special{html:);">}#1\special{html:</button>}
\else
\phantom{#1}
\fi
}

%----------------- Makros fuer die modularisierte Darstellung ------------------------------------

\def\MyText#1{#1}

% is used internally by the conversion package, should not be used by original tex documents
\def\MOrgLabel#1{\relax}

\ifttm

% Ein MLabel wird im html codiert durch das tag <!-- mmlabel;;Labelbezeichner;;SubjectArea;;chapter;;section;;subsection;;Index;;Objekttyp; //-->
\def\MLabel#1{%
\ifnum\value{MLastType}=8%
\ifnum\value{MCaptionOn}=0%
\MDebugMessage{ERROR: Grafik \arabic{MGraphicsCounter} hat separates label: #1 (Grafiklabels sollten nur in der Caption stehen)}%
\fi
\fi
\ifnum\value{MLastType}=12%
\ifnum\value{MCaptionOn}=0%
\MDebugMessage{ERROR: Video \arabic{MVideoCounter} hat separates label: #1 (Videolabels sollten nur in der Caption stehen}%
\fi
\fi
\ifnum\value{MLastType}=10\setcounter{MLastIndex}{\value{equation}}\fi
\label{#1}\begin{html}<!-- mmlabel;;#1;;\end{html}\arabic{MSubjectArea}\special{html:;;}\arabic{chapter}\special{html:;;}\arabic{section}\special{html:;;}\arabic{subsection}\special{html:;;}\arabic{MLastIndex}\special{html:;;}\arabic{MLastType}\special{html:; //-->}}%

\else

% Sonderbehandlung im PDF fuer Abbildungen in separater aux-Datei, da MGraphics die figure-Umgebung nicht verwendet
\def\MLabel#1{%
\ifnum\value{MLastType}=8%
\ifnum\value{MCaptionOn}=0%
\MDebugMessage{ERROR: Grafik \arabic{MGraphicsCounter} hat separates label: #1 (Grafiklabels sollten nur in der Caption stehen}%
\fi
\fi
\ifnum\value{MLastType}=12%
\ifnum\value{MCaptionOn}=0%
\MDebugMessage{ERROR: Video \arabic{MVideoCounter} hat separates label: #1 (Videolabels sollten nur in der Caption stehen}%
\fi
\fi
\label{#1}%
}%

\fi

% Gibt Begriff des referenzierten Objekts mit aus, aber nur im HTML, daher nur in Ausnahmefaellen (z.B. Copyrightliste) sinnvoll
\def\MCRef#1{\ifttm\special{html:<!-- mmref;;}#1\special{html:;;1; //-->}\else\vref{#1}\fi}


\def\MRef#1{\ifttm\special{html:<!-- mmref;;}#1\special{html:;;0; //-->}\else\vref{#1}\fi}
\def\MERef#1{\ifttm\special{html:<!-- mmref;;}#1\special{html:;;0; //-->}\else\eqref{#1}\fi}
\def\MNRef#1{\ifttm\special{html:<!-- mmref;;}#1\special{html:;;0; //-->}\else\ref{#1}\fi}
\def\MSRef#1#2{\ifttm\special{html:<!-- msref;;}#1\special{html:;;}#2\special{html:; //-->}\else \if#2\empty \ref{#1} \else \hyperref[#1]{#2}\fi\fi}

\def\MRefRange#1#2{\ifttm\MRef{#1} bis
\MRef{#2}\else\vrefrange[\unskip]{#1}{#2}\fi}

\def\MRefTwo#1#2{\ifttm\MRef{#1} und \MRef{#2}\else%
\let\vRefTLRsav=\reftextlabelrange\let\vRefTPRsav=\reftextpagerange%
\def\reftextlabelrange##1##2{\ref{##1} und~\ref{##2}}%
\def\reftextpagerange##1##2{auf den Seiten~\pageref{#1} und~\pageref{#2}}%
\vrefrange[\unskip]{#1}{#2}%
\let\reftextlabelrange=\vRefTLRsav\let\reftextpagerange=\vRefTPRsav\fi}

% MSectionChapter definiert falls notwendig das Kapitel vor der section. Das ist notwendig, wenn nur ein Einzelmodul uebersetzt wird.
% MChaptersGiven ist ein Counter, der von mconvert.pl vordefiniert wird.
\ifttm
\newcommand{\MSectionChapter}{\ifnum\value{MChaptersGiven}=0{\Dchapter{Modul}}\else{}\fi}
\else
\newcommand{\MSectionChapter}{\ifnum\value{chapter}=0{\Dchapter{Modul}}\else{}\fi}
\fi


\def\MChapter#1{\ifnum\value{MSSEnd}>0{\MSubsectionEndMacros}\addtocounter{MSSEnd}{-1}\fi\Dchapter{#1}}
\def\MSubject#1{\MChapter{#1}} % Schluesselwort HELPSECTION ist reserviert fuer Hilfesektion

\newcommand{\MSectionID}{UNKNOWNID}

\ifttm
\newcommand{\MSetSectionID}[1]{\renewcommand{\MSectionID}{#1}}
\else
\newcommand{\MSetSectionID}[1]{\renewcommand{\MSectionID}{#1}\tikzsetexternalprefix{#1}}
\fi


\newcommand{\MSection}[1]{\MSetSectionID{MODULID}\ifnum\value{MSSEnd}>0{\MSubsectionEndMacros}\addtocounter{MSSEnd}{-1}\fi\MSectionChapter\Dsection{#1}\MSectionStartMacros{#1}\setcounter{MLastIndex}{-1}\setcounter{MLastType}{1}} % Sections werden ueber das section-Feld im mmlabel-Tag identifiziert, nicht ueber das Indexfeld

\def\MSubsection#1{\ifnum\value{MSSEnd}>0{\MSubsectionEndMacros}\addtocounter{MSSEnd}{-1}\fi\ifttm\else\clearpage\fi\Dsubsection{#1}\MSubsectionStartMacros\setcounter{MLastIndex}{-1}\setcounter{MLastType}{2}\addtocounter{MSSEnd}{1}}% Subsections werden ueber das subsection-Feld im mmlabel-Tag identifiziert, nicht ueber das Indexfeld
\def\MSubsectionx#1{\Dsubsectionx{#1}} % Nur zur Verwendung in MSectionStart gedacht
\def\MSubsubsection#1{\Dsubsubsection{#1}\setcounter{MLastIndex}{\value{subsubsection}}\setcounter{MLastType}{3}\ifttm\special{html:<!-- sectioninfo;;}\arabic{section}\special{html:;;}\arabic{subsection}\special{html:;;}\arabic{subsubsection}\special{html:;;1;;}\arabic{MTestSite}\special{html:; //-->}\fi}
\def\MSubsubsectionx#1{\Dsubsubsectionx{#1}\ifttm\special{html:<!-- sectioninfo;;}\arabic{section}\special{html:;;}\arabic{subsection}\special{html:;;}\arabic{subsubsection}\special{html:;;0;;}\arabic{MTestSite}\special{html:; //-->}\else\addcontentsline{toc}{subsection}{#1}\fi}

\ifttm
\def\MSubsubsubsectionx#1{\ \newline\textbf{#1}\special{html:<br />}}
\else
\def\MSubsubsubsectionx#1{\ \newline
\textbf{#1}\ \\
}
\fi


% Dieses Skript wird zu Beginn jedes Modulabschnitts (=Webseite) ausgefuehrt und initialisiert den Aufgabenfeldzaehler
\newcommand{\MPageScripts}{
\setcounter{MFieldCounter}{1}
\addtocounter{MSiteCounter}{1}
\setcounter{MHintCounter}{1}
\setcounter{MCodeEditCounter}{1}
\setcounter{MGroupActive}{0}
\DoQBoxes
% Feldvariablen werden im HTML-Header in conv.pl eingestellt
}

% Dieses Skript wird zum Ende jedes Modulabschnitts (=Webseite) ausgefuehrt
\ifttm
\newcommand{\MEndScripts}{\special{html:<br /><!-- mfeedbackbutton;Seite;}\arabic{MTestSite}\special{html:;}\MGenerateSiteNumber\special{html:; //-->}
}
\else
\newcommand{\MEndScripts}{\relax}
\fi


\newcounter{QBoxFlag}
\newcommand{\DoQBoxes}{\setcounter{QBoxFlag}{1}}
\newcommand{\NoQBoxes}{\setcounter{QBoxFlag}{0}}

\newcounter{MXCTest}
\newcounter{MXCounter}
\newcounter{MSCounter}



\ifttm

% Struktur des sectioninfo-Tags: <!-- sectioninfo;;section;;subsection;;subsubsection;;nr_ausgeben;;testpage; //-->

%Fuegt eine zusaetzliche html-Seite an hinter ALLEN bisherigen und zukuenftigen content-Seiten ausserhalb der vor-zurueck-Schleife (d.h. nur durch Button oder MIntLink erreichbar!)
% #1 = Titel des Modulabschnitts, #2 = Kurztitel fuer die Buttons, #3 = Buttonkennung (STD = default nehmen, NONE = Ohne Button in der Navigation)
\newenvironment{MSContent}[3]{\special{html:<div class="xcontent}\arabic{MSCounter}\special{html:"><!-- scontent;-;}\arabic{MSCounter};-;#1;-;#2;-;#3\special{html: //-->}\MPageScripts\MSubsubsectionx{#1}}{\MEndScripts\special{html:<!-- endscontent;;}\arabic{MSCounter}\special{html: //--></div>}\addtocounter{MSCounter}{1}}

% Fuegt eine zusaetzliche html-Seite ein hinter den bereits vorhandenen content-Seiten (oder als erste Seite) innerhalb der vor-zurueck-Schleife der Navigation
% #1 = Titel des Modulabschnitts, #2 = Kurztitel fuer die Buttons, #3 = Buttonkennung (STD = Defaultbutton, NONE = Ohne Button in der Navigation)
\newenvironment{MXContent}[3]{\special{html:<div class="xcontent}\arabic{MXCounter}\special{html:"><!-- xcontent;-;}\arabic{MXCounter};-;#1;-;#2;-;#3\special{html: //-->}\MPageScripts\MSubsubsection{#1}}{\MEndScripts\special{html:<!-- endxcontent;;}\arabic{MXCounter}\special{html: //--></div>}\addtocounter{MXCounter}{1}}

% Fuegt eine zusaetzliche html-Seite ein die keine subsubsection-Nummer bekommt, nur zur internen Verwendung in mintmod.tex gedacht!
% #1 = Titel des Modulabschnitts, #2 = Kurztitel fuer die Buttons, #3 = Buttonkennung (STD = Defaultbutton, NONE = Ohne Button in der Navigation)
% \newenvironment{MUContent}[3]{\special{html:<div class="xcontent}\arabic{MXCounter}\special{html:"><!-- xcontent;-;}\arabic{MXCounter};-;#1;-;#2;-;#3\special{html: //-->}\MPageScripts\MSubsubsectionx{#1}}{\MEndScripts\special{html:<!-- endxcontent;;}\arabic{MXCounter}\special{html: //--></div>}\addtocounter{MXCounter}{1}}

\newcommand{\MDeclareSiteUXID}[1]{\special{html:<!-- mdeclaresiteuxid;;}#1\special{html:;;}\arabic{chapter}\special{html:;;}\arabic{section}\special{html:;; //-->}}

\else

%\newcommand{\MSubsubsection}[1]{\refstepcounter{subsubsection} \addcontentsline{toc}{subsubsection}{\thesubsubsection. #1}}


% Fuegt eine zusaetzliche html-Seite an hinter den bereits vorhandenen content-Seiten
% #1 = Titel des Modulabschnitts, #2 = Kurztitel fuer die Buttons, #3 = Iconkennung (im PDF wirkungslos)
%\newenvironment{MUContent}[3]{\ifnum\value{MXCTest}>0{\MDebugMessage{ERROR: Geschachtelter SContent}}\fi\MPageScripts\MSubsubsectionx{#1}\addtocounter{MXCTest}{1}}{\addtocounter{MXCounter}{1}\addtocounter{MXCTest}{-1}}
\newenvironment{MXContent}[3]{\ifnum\value{MXCTest}>0{\MDebugMessage{ERROR: Geschachtelter SContent}}\fi\MPageScripts\MSubsubsection{#1}\addtocounter{MXCTest}{1}}{\addtocounter{MXCounter}{1}\addtocounter{MXCTest}{-1}}
\newenvironment{MSContent}[3]{\ifnum\value{MXCTest}>0{\MDebugMessage{ERROR: Geschachtelter XContent}}\fi\MPageScripts\MSubsubsectionx{#1}\addtocounter{MXCTest}{1}}{\addtocounter{MSCounter}{1}\addtocounter{MXCTest}{-1}}

\newcommand{\MDeclareSiteUXID}[1]{\relax}

\fi

% GHEADER und GFOOTER werden von split.pm gefunden, aber nur, wenn nicht HELPSITE oder TESTSITE
\ifttm
\newenvironment{MSectionStart}{\special{html:<div class="xcontent0">}\MSubsubsectionx{\iModuleOverview{}}}{\setcounter{MSSEnd}{0}\special{html:</div>}}
% Darf nicht als XContent nummeriert werden, darf nicht als XContent gelabelt werden, wird aber in eine xcontent-div gesetzt fuer Python-parsing
\else
\newenvironment{MSectionStart}{\MSubsectionx{\iModuleOverview{}}}{\setcounter{MSSEnd}{0}}
\fi

\ifttm
\newenvironment{MIntro}{\begin{MXContent}{\iIntroduction{}}{\iIntroduction{}}{genetisch}\begin{html}<div
class="intro">\end{html}}{\begin{html}</div>\end{html}\end{MXContent}}
\else
\newenvironment{MIntro}{\begin{MXContent}{\iIntroduction{}}{\iIntroduction{}}{genetisch}}{\end{MXContent}}
\fi

\newenvironment{MContent}{\begin{MXContent}{\iContents{}}{\iContents{}}{beweis}}{\end{MXContent}}
\newenvironment{MExercises}{\ifttm\else\clearpage\fi\begin{MXContent}{\iExercises{}}{\iExercises{}}{aufgb}\special{html:<!-- declareexcsymb //-->}}{\end{MXContent}}

% #1 = Lesbare Testbezeichnung
\newenvironment{MTest}[1]{%
\renewcommand{\MTestName}{#1}
\ifttm\else\clearpage\fi%
\addtocounter{MTestSite}{1}%
\begin{MXContent}{#1}{#1}{STD} % {aufgb}%
\special{html:<!-- declaretestsymb //-->}
\begin{MQuestionGroup}%
\MInTestHeader
}%
{%
\end{MQuestionGroup}%
\ \\ \ \\%
\MInTestFooter
\end{MXContent}\addtocounter{MTestSite}{-1}%
}

\newenvironment{MExtra}{\ifttm\else\clearpage\fi\begin{MXContent}{ZusÃ¤tzliche Inhalte}{Zusatz}{weiterfhrg}}{\end{MXContent}}

\makeindex

\ifttm
\def\MPrintIndex{
\ifnum\value{MSSEnd}>0{\MSubsectionEndMacros}\addtocounter{MSSEnd}{-1}\fi
\renewcommand{\indexname}{Index}
\special{html:<p><!-- printindex //--></p>}
}
\else
\def\MPrintIndex{
\ifnum\value{MSSEnd}>0{\MSubsectionEndMacros}\addtocounter{MSSEnd}{-1}\fi
\renewcommand{\indexname}{Index}
\addcontentsline{toc}{section}{Index}
\printindex
}
\fi


% Konstanten fuer die Modulfaecher

\def\MINTMathematics{1}
\def\MINTInformatics{2}
\def\MINTChemistry{3}
\def\MINTPhysics{4}
\def\MINTEngineering{5}

\newcounter{MSubjectArea}
\newcounter{MInfoNumbers} % Gibt an, ob die Infoboxen nummeriert werden sollen
\newcounter{MSepNumbers} % Gibt an, ob Beispiele und Experimente separat nummeriert werden sollen
\newcommand{\MSetSubject}[1]{
 % ttm kapiert setcounter mit Parametern nicht, also per if abragen und einsetzen
\ifnum#1=1\setcounter{MSubjectArea}{1}\setcounter{MInfoNumbers}{1}\setcounter{MSepNumbers}{0}\fi
\ifnum#1=2\setcounter{MSubjectArea}{2}\setcounter{MInfoNumbers}{1}\setcounter{MSepNumbers}{0}\fi
\ifnum#1=3\setcounter{MSubjectArea}{3}\setcounter{MInfoNumbers}{0}\setcounter{MSepNumbers}{1}\fi
\ifnum#1=4\setcounter{MSubjectArea}{4}\setcounter{MInfoNumbers}{0}\setcounter{MSepNumbers}{0}\fi
\ifnum#1=5\setcounter{MSubjectArea}{5}\setcounter{MInfoNumbers}{1}\setcounter{MSepNumbers}{0}\fi
% Separate Nummerntechnik fuer unsere Chemiker: alles dreistellig
\ifnum#1=3
  \ifttm
  \renewcommand{\theequation}{\arabic{section}.\arabic{subsection}.\arabic{equation}}
  \renewcommand{\thetable}{\arabic{section}.\arabic{subsection}.\arabic{table}}
  \renewcommand{\thefigure}{\arabic{section}.\arabic{subsection}.\arabic{figure}}
  \else
  \renewcommand{\theequation}{\arabic{chapter}.\arabic{section}.\arabic{equation}}
  \renewcommand{\thetable}{\arabic{chapter}.\arabic{section}.\arabic{table}}
  \renewcommand{\thefigure}{\arabic{chapter}.\arabic{section}.\arabic{figure}}
  \fi
\else
  \ifttm
  \renewcommand{\theequation}{\arabic{section}.\arabic{subsection}.\arabic{equation}}
  \renewcommand{\thetable}{\arabic{table}}
  \renewcommand{\thefigure}{\arabic{figure}}
  \else
  \renewcommand{\theequation}{\arabic{chapter}.\arabic{section}.\arabic{equation}}
  \renewcommand{\thetable}{\arabic{table}}
  \renewcommand{\thefigure}{\arabic{figure}}
  \fi
\fi
}

% Fuer tikz Autogenerierung
\newcounter{MTIKZAutofilenumber}

% Spezielle Counter fuer die Bentz-Module
\newcounter{mycounter}
\newcounter{chemapplet}
\newcounter{physapplet}

\newcounter{MSSEnd} % Ist 1 falls ein MSubsection aktiv ist, der einen MSubsectionEndMacro-Aufruf verursacht
\newcounter{MFileNumber}
\def\MLastFile{\special{html:[[!-- mfileref;;}\arabic{MFileNumber}\special{html:; //--]]}}

% Vollstaendiger Pfad ist \MMaterial / \MLastFilePath / \MLastFileName    ==   \MMaterial / \MLastFile

% Wird nur bei kompletter Baum-Erstellung ausgefuehrt!
% #1 = Lesbare Modulbezeichnung
\newcommand{\MSectionStartMacros}[1]{
\setcounter{MTestSite}{0}
\setcounter{MCaptionOn}{0}
\setcounter{MLastTypeEq}{0}
\setcounter{MSSEnd}{0}
\setcounter{MFileNumber}{0} % Preinkrekement-Counter
\setcounter{MTIKZAutofilenumber}{0}
\setcounter{mycounter}{1}
\setcounter{physapplet}{1}
\setcounter{chemapplet}{0}
\ifttm
\special{html:<!-- mdeclaresection;;}\arabic{chapter}\special{html:;;}\arabic{section}\special{html:;;}#1\special{html:;; //-->}%
\else
\setcounter{thmc}{0}
\setcounter{exmpc}{0}
\setcounter{verc}{0}
\setcounter{infoc}{0}
\fi
\setcounter{MiniMarkerCounter}{1}
\setcounter{AlignCounter}{1}
\setcounter{MXCTest}{0}
\setcounter{MCodeCounter}{0}
\setcounter{MEntryCounter}{0}
}

% Wird immer ausgefuehrt
\newcommand{\MSubsectionStartMacros}{
\ifttm\else\MPageHeaderDef\fi
\MWatermarkSettings
\setcounter{MXCounter}{0}
\setcounter{MSCounter}{0}
\setcounter{MSiteCounter}{1}
\setcounter{MExerciseCollectionCounter}{0}
% Zaehler fuer das Labelsystem zuruecksetzen (prefix-Zaehler)
\setcounter{MInfoCounter}{0}
\setcounter{MExerciseCounter}{0}
\setcounter{MExampleCounter}{0}
\setcounter{MExperimentCounter}{0}
\setcounter{MGraphicsCounter}{0}
\setcounter{MTableCounter}{0}
\setcounter{MTheoremCounter}{0}
\setcounter{MObjectCounter}{0}
\setcounter{MEquationCounter}{0}
\setcounter{MVideoCounter}{0}
\setcounter{equation}{0}
\setcounter{figure}{0}
}

\newcommand{\MSubsectionEndMacros}{
% Bei Chemiemodulen das PSE einhaengen, es soll als SContent am Ende erscheinen
\special{html:<!-- subsectionend //-->}
\ifnum\value{MSubjectArea}=3{\MIncludePSE}\fi
}


\ifttm
%\newcommand{\MEmbed}[1]{\MRegisterFile{#1}\begin{html}<embed src="\end{html}\MMaterial/\MLastFile\begin{html}" width="192" height="189"></embed>\end{html}}
\newcommand{\MEmbed}[1]{\MRegisterFile{#1}\begin{html}<embed src="\end{html}\MMaterial/\MLastFile\begin{html}"></embed>\end{html}}
\fi

%----------------- Makros fuer die Textdarstellung -----------------------------------------------

\ifttm
% MUGraphics bindet eine Grafik ein:
% Parameter 1: Dateiname der Grafik, relativ zur Position des Modul-Tex-Dokuments
% Parameter 2: Skalierungsoptionen fuer PDF (fuer includegraphics)
% Parameter 3: Titel fuer die Grafik, wird unter die Grafik mit der Grafiknummer gesetzt und kann MLabel bzw. MCopyrightLabel enthalten
% Parameter 4: Skalierungsoptionen fuer HTML (css-styles)

% ERSATZ: <img alt="My Image" src="data:image/png;base64,iVBORwA<MoreBase64SringHere>" />


\newcommand{\MUGraphics}[4]{\MRegisterFile{#1}\begin{html}
<div class="imagecenter">
<center>
<div>
%<img src="\end{html}\MMaterial/\MLastFile\begin{html}" style="#4" alt="\end{html}\MMaterial/\MLastFile\begin{html}"/>
<img class="mintmodimage" src="../../images/\end{html}#1\begin{html}"/>
</div>
<div class="bildtext">
\end{html}
\addtocounter{MGraphicsCounter}{1}
\setcounter{MLastIndex}{\value{MGraphicsCounter}}
\setcounter{MLastType}{8}
\addtocounter{MCaptionOn}{1}
\ifnum\value{MSepNumbers}=0
\textbf{Abbildung \arabic{MGraphicsCounter}:} #3
\else
\textbf{Abbildung \arabic{section}.\arabic{subsection}.\arabic{MGraphicsCounter}:} #3
\fi
\addtocounter{MCaptionOn}{-1}
\begin{html}
</div>
</center>
</div>
<br />
\end{html}%
\special{html:<!-- mfeedbackbutton;Abbildung;}\arabic{MGraphicsCounter}\special{html:;}\arabic{section}.\arabic{subsection}.\arabic{MGraphicsCounter}\special{html:; //-->}%
}

% MVideo bindet ein Video als Einzeldatei ein:
% Parameter 1: Dateiname des Videos, relativ zur Position des Modul-Tex-Dokuments, ohne die Endung ".mp4"
% Parameter 2: Titel fuer das Video (kann MLabel oder MCopyrightLabel enthalten), wird unter das Video mit der Videonummer gesetzt
\newcommand{\MVideo}[2]{\MRegisterFile{#1.mp4}\begin{html}
<div class="imagecenter">
<center>
<div>
<video width="95\%" controls="controls"><source src="\end{html}\MMaterial/#1.mp4\begin{html}" type="video/mp4">Ihr Browser kann keine MP4-Videos abspielen!</video>
</div>
<div class="bildtext">
\end{html}
\addtocounter{MVideoCounter}{1}
\setcounter{MLastIndex}{\value{MVideoCounter}}
\setcounter{MLastType}{12}
\addtocounter{MCaptionOn}{1}
\ifnum\value{MSepNumbers}=0
\textbf{Video \arabic{MVideoCounter}:} #2
\else
\textbf{Video \arabic{section}.\arabic{subsection}.\arabic{MVideoCounter}:} #2
\fi
\addtocounter{MCaptionOn}{-1}
\begin{html}
</div>
</center>
</div>
<br />
\end{html}}

\newcommand{\MDVideo}[2]{\MRegisterFile{#1.mp4}\MRegisterFile{#1.ogv}\begin{html}
<div class="imagecenter">
<center>
<div>
<video width="70\%" controls><source src="\end{html}\MMaterial/#1.mp4\begin{html}" type="video/mp4"><source src="\end{html}\MMaterial/#1.ogv\begin{html}" type="video/ogg">Ihr Browser kann keine MP4-Videos abspielen!</video>
</div>
<br />
#2
</center>
</div>
<br />
\end{html}
}

\newcommand{\MGraphics}[3]{\MUGraphics{#1}{#2}{#3}{}}

\else

\newcommand{\MVideo}[2]{%
% Kein Video im PDF darstellbar, trotzdem so tun als ob da eines waere
\begin{center}
(\iVideoWarn{})
\end{center}
\addtocounter{MVideoCounter}{1}
\setcounter{MLastIndex}{\value{MVideoCounter}}
\setcounter{MLastType}{12}
\addtocounter{MCaptionOn}{1}
\ifnum\value{MSepNumbers}=0
\textbf{Video \arabic{MVideoCounter}:} #2
\else
\textbf{Video \arabic{section}.\arabic{subsection}.\arabic{MVideoCounter}:} #2
\fi
\addtocounter{MCaptionOn}{-1}
}


% MGraphics bindet eine Grafik ein:
% Parameter 1: Dateiname der Grafik, relativ zur Position des Modul-Tex-Dokuments
% Parameter 2: Skalierungsoptionen fuer PDF (fuer includegraphics)
% Parameter 3: Titel fuer die Grafik, wird unter die Grafik mit der Grafiknummer gesetzt
\newcommand{\MGraphics}[3]{%
\MRegisterFile{#1}%
\ %
\begin{figure}[H]%
\centering{%
\includegraphics[#2]{\MDPrefix/#1}%
\addtocounter{MCaptionOn}{1}%
\caption{#3}%
\addtocounter{MCaptionOn}{-1}%
}%
\end{figure}%
\addtocounter{MGraphicsCounter}{1}\setcounter{MLastIndex}{\value{MGraphicsCounter}}\setcounter{MLastType}{8}\ %
%\ \\Abbildung \ifnum\value{MSepNumbers}=0\else\arabic{chapter}.\arabic{section}.\fi\arabic{MGraphicsCounter}: #3%
}

\newcommand{\MUGraphics}[4]{\MGraphics{#1}{#2}{#3}}


\fi

\newcounter{MCaptionOn} % = 1 falls eine Grafikcaption aktiv ist, = 0 sonst


% MGraphicsSolo bindet eine Grafik pur ein ohne Titel
% Parameter 1: Dateiname der Grafik, relativ zur Position des Modul-Tex-Dokuments
% Parameter 2: Skalierungsoptionen (wirken nur im PDF)
\newcommand{\MGraphicsSolo}[2]{\MUGraphicsSolo{#1}{#2}{}}

% MUGraphicsSolo bindet eine Grafik pur ein ohne Titel, aber mit HTML-Skalierung
% Parameter 1: Dateiname der Grafik, relativ zur Position des Modul-Tex-Dokuments
% Parameter 2: Skalierungsoptionen (wirken nur im PDF)
% Parameter 3: Skalierungsoptionen (wirken nur im HTML), als style-format: "width=???, height=???"
\ifttm
\newcommand{\MUGraphicsSolo}[3]{\MRegisterFile{#1}
% unecessarily convoluted. Use deploy script for images, not tex converter.
%\begin{html}
%<img src="\end{html}\MMaterial/\MLastFile\begin{html}" style="\end{html}#3\begin{html}" alt="\end{html}\MMaterial/\MLastFile\begin{html}"/>
\begin{html}<img class="mintmodimage" src="../../images/\end{html}#1\begin{html}"/>\end{html}
%\end{html}%
\special{html:<!-- mfeedbackbutton;Abbildung;}#1\special{html:;}\MMaterial/\MLastFile\special{html:; //-->}%
}
\else
\newcommand{\MUGraphicsSolo}[3]{\MRegisterFile{#1}\includegraphics[#2]{\MDPrefix/#1}}
\fi

% Externer Link mit URL
% Erster Parameter: Vollstaendige(!) URL des Links
% Zweiter Parameter: Text fuer den Link
\newcommand{\MExtLink}[2]{\ifttm\special{html:<a target="_new" href="}#1\special{html:">}#2\special{html:</a>}\else\href{#1}{#2}\fi} % ohne MINTERLINK!


% Interner Link, die verlinkte Datei muss im gleichen Verzeichnis liegen wie die Modul-Texdatei
% Erster Parameter: Dateiname
% Zweiter Parameter: Text fuer den Link
\newcommand{\MIntLink}[2]{\ifttm\MRegisterFile{#1}\special{html:<a class="MINTERLINK" target="_new" href="}\MMaterial/\MLastFile\special{html:">}#2\special{html:</a>}\else{\href{#1}{#2}}\fi}


\ifttm
\def\MMaterial{:localmaterial:}
\else
\def\MMaterial{\MDPrefix}
\fi

\ifttm
\def\MNoFile#1{:directmaterial:#1}
\else
\def\MNoFile#1{#1}
\fi

\newcommand{\MChem}[1]{$\mathrm{#1}$}

\newcommand{\MApplet}[3]{
% Bindet ein Java-Applet ein, die Parameter sind:
% (wird nur im HTML, aber nicht im PDF erstellt)
% #1 Dateiname des Applets (muss mit ".class" enden)
% #2 = Breite in Pixeln
% #3 = Hoehe in Pixeln
\ifttm
\MRegisterFile{#1}
\begin{html}
<applet code="\end{html}\MMaterial/\MLastFile\begin{html}" width="#2" height="#3" alt="[Java-Applet kann nicht gestartet werden]"></applet>
\end{html}
\fi
}

\newcommand{\MScriptPage}[2]{
% Bindet eine JavaScript-Datei ein, die eine eigene Seite bekommt
% (wird nur im HTML, aber nicht im PDF erstellt)
% #1 Dateiname des Programms (sollte mit ".js" enden)
% #2 = Kurztitel der Seite
\ifttm
\begin{MSContent}{#2}{#2}{puzzle}
\MRegisterFile{#1}
\begin{html}
<script src="\MMaterial/\MLastFile" type="text/javascript"></script>
\end{html}
\end{MSContent}
\fi
}

% Bindet in der Haupttexdatei ein MINT-Modul ein. Parameter 1 ist das Verzeichnis (relativ zur Haupttexdatei), Parameter 2 ist der Dateinahme ohne Pfad.
\newcommand{\IncludeModule}[2]{
\renewcommand{\MDPrefix}{#1}
\input{#1/#2}
\ifnum\value{MSSEnd}>0{\MSubsectionEndMacros}\addtocounter{MSSEnd}{-1}\fi
}

% Der ttm-Konverter setzt keine Makros im \input um, also muss hier getrickst werden:
% Das MDPrefix muss in den einzelnen Modulen manuell eingesetzt werden
\newcommand{\MInputFile}[1]{
\ifttm
\input{#1}
\else
\input{#1}
\fi
}


\newcommand{\MCases}[1]{\left\lbrace{\begin{array}{rl} #1 \end{array}}\right.}

\ifttm
\newenvironment{MCaseEnv}{\left\lbrace\begin{array}{rl}}{\end{array}\right.}
\else
\newenvironment{MCaseEnv}{\left\lbrace\begin{array}{rl}}{\end{array}\right.}
\fi

\def\MSkip{\ifttm\MCR\fi}

\ifttm
\def\MCR{\special{html:<br />}}
\else
\def\MCR{\ \\}
\fi


% Pragmas - Sind Schluesselwoerter, die dem Preprocessing sowie dem Konverter uebergeben werden und bestimmte
%           Aktionen ausloesen. Im Output (PDF und HTML) tauchen sie nicht auf.
\newcommand{\MPragma}[1]{%
\ifttm%
\special{html:<!-- mpragma;-;}#1\special{html:;; -->}%
\else%
% MPragmas werden vom Preprozessor direkt im LaTeX gefunden
\fi%
}

% Ersatz der Befehle textsubscript und textsuperscript, die ttm nicht kennt
\ifttm%
\newcommand{\MTextsubscript}[1]{\special{html:<sub>}#1\special{html:</sub>}}%
\newcommand{\MTextsuperscript}[1]{\special{html:<sup>}#1\special{html:</sup>}}%
\else%
\newcommand{\MTextsubscript}[1]{\textsubscript{#1}}%
\newcommand{\MTextsuperscript}[1]{\textsuperscript{#1}}%
\fi

%------------------ Einbindung von dia-Diagrammen ----------------------------------------------
% Beim preprocessing wird aus jeder dia-Datei eine tex-Datei und eine pdf-Datei erzeugt,
% diese werden hier jeweils im PDF und HTML eingebunden
% Parameter: Dateiname der mit dia erstellten Datei (OHNE die Endung .dia)
\ifttm%
\newcommand{\MDia}[1]{%
\MGraphicsSolo{#1minthtml.png}{}%
}
\else%
\newcommand{\MDia}[1]{%
\MGraphicsSolo{#1mintpdf.png}{scale=0.1667}%
}
\fi%

% subsup funktioniert im Ausdruck $D={\R}^+_0$, also \R geklammert und sup zuerst
% \ifttm
% \def\MSubsup#1#2#3{\special{html:<msubsup>} #1 #2 #3\special{html:</msubsup>}}
% \else
% \def\MSubsup#1#2#3{{#1}^{#3}_{#2}}
% \fi

%\input{local.tex}

% \ifttm
% \else
% \newwrite\mintlog
% \immediate\openout\mintlog=mintlog.txt
% \fi

% ----------------------- tikz autogenerator -------------------------------------------------------------------

\newcommand{\Mtikzexternalize}{\tikzexternalize}% wird bei Konvertierung ueber mconvert ggf. ausgehebelt!

\ifttm
\else
\tikzset%
{
  % Defines a custom style which generates pdf and converts to (low and hi-res quality) png and svg, then deletes the pdf
  % Important: DO NOT directly convert from pdf to hires-png or from svg to png with GraphViz convert as it has some problems and memory leaks
  png export/.style=%
  {
    external/system call/.add={}{;
      pdf2svg "\image.pdf" "\image.svg" ;
      convert -density 112.5 -transparent white "\image.pdf" "\image.png";
      inkscape --export-png="\image.4x.png" --export-dpi=450 --export-background-opacity=0 --without-gui "\image.svg";
      rm "\image.pdf"; rm "\image.log"; rm "\image.dpth"; rm "\image.idx"
    },
    external/force remake,
  }
}
\tikzset{png export}
\tikzsetexternalprefix{}
% PNGs bei externer Erzeugung in "richtiger" Groesse einbinden
\pgfkeys{/pgf/images/include external/.code={\includegraphics[scale=0.64]{#1}}}
\fi

% Spezielle Umgebung fuer Autogenerierung, Bildernamen sind nur innerhalb eines Moduls (einer MSection) eindeutig)

\newcommand{\MTIKZautofilename}{tikzautofile}

\ifttm
% HTML-Version: Vom Autogenerator erzeugte png-Datei einbinden, tikz selbst nicht ausfuehren (sprich: #1 schlucken)
\newcommand{\MTikzAuto}[1]{%
\addtocounter{MTIKZAutofilenumber}{1}
\renewcommand{\MTIKZautofilename}{mtikzauto_\arabic{MTIKZAutofilenumber}}
\MUGraphicsSolo{\MSectionID\MTIKZautofilename.4x.png}{scale=1}{\special{html:[[!-- svgstyle;}\MSectionID\MTIKZautofilename\special{html: //--]]}} % Styleinfos werden aus original-png, nicht 4x-png geholt!
%\MRegisterFile{\MSectionID\MTIKZautofilename.png} % not used right now
%\MRegisterFile{\MSectionID\MTIKZautofilename.svg}
}
\else%
% PDF-Version: Falls Autogenerator aktiv wird Datei automatisch benannt und exportiert
\newcommand{\MTikzAuto}[1]{%
\addtocounter{MTIKZAutofilenumber}{1}%
\renewcommand{\MTIKZautofilename}{mtikzauto_\arabic{MTIKZAutofilenumber}}
\tikzsetnextfilename{\MTIKZautofilename}%
#1%
}
\fi

% In einer reinen LaTeX-Uebersetzung kapselt der Preambelinclude-Befehl nur input,
% in einer konvertergesteuerten PDF/HTML-Uebersetzung wird er dagegen entfernt und
% die Preambeln an mintmod angehaengt, die Ersetzung wird von mconvert.pl vorgenommen.

\newcommand{\MPreambleInclude}[1]{\input{#1}}

% Globale Watermarksettings (werden auch nochmal zu Beginn jedes subsection gesetzt,
% muessen hier aber auch global ausgefuehrt wegen Einfuehrungsseiten und Inhaltsverzeichnis

\MWatermarkSettings

% ---------------------------------- Spezialbefehle fuer AD ------------------------------------------

%Abkuerzung fuer \longrightarrow:
\newcommand{\lto}{\ensuremath{\longrightarrow}}

%Makro fuer Funktionen:
\newcommand{\exfunction}[5]
{\begin{array}{rrcl}
 #1 \colon  & #2 &\lto & #3 \\[.05cm]
  & #4 &\longmapsto  & #5
\end{array}}

\newcommand{\function}[5]{%
#1:\;\left\lbrace{\begin{array}{rcl}
 #2 &\lto & #3 \\
 #4 &\longmapsto  & #5 \end{array}}\right.}


%Die Identitaet:
\DeclareMathOperator{\Id}{Id}

%Die Signumfunktion:
\DeclareMathOperator{\sgn}{sgn}

%Zwei Betonungskommandos (koennen angepasst werden):
\newcommand{\highlight}[1]{#1}
\newcommand{\modstextbf}[1]{#1}
\newcommand{\modsemph}[1]{#1}


\ifttm%
\newcommand{\MModstartBox}{\special{html:<!-- modstartbox //-->}}
\else%
\newcommand{\MModstartBox}{%
\relax
}
\fi

% ---------------------------------- Spezialbefehle fuer JL ------------------------------------------


\def\jccolorfkt{green!50!black} %Farbe des Funktionsgraphen
\def\jccolorfktarea{green!25!white} %Farbe der FlÃ¤che unter dem Graphen
\def\jccolorfktareahell{green!12!white} %helle EinfÃ¤rbung der FlÃ¤che unter dem Graphen
\def\jccolorfktwert{green!50!black} %Farbe einzelner Punkte des Graphen

\newcommand{\MPfadBilder}{Bilder}

\ifttm%
\newcommand{\jMD}{\,\MD}%
\else%
\newcommand{\jMD}{\;\MD}%
\fi%

\def\MFormelZoomHint{\MInputHint{%
\iFormZoomHint{}}}

\def\jHTMLHinweisBedienung{\MInputHint{%
\iUsageHint{}}}

\def\jHTMLHinweisEingabeText{\MInputHint{%
\iTextInputHint{}}}

\def\jHTMLHinweisEingabeTerm{\MInputHint{%
\iTermInputHint{}}}

\def\jHTMLHinweisEingabeIntervalle{\MInputHint{%
\iIntervalInputHint{}}}

\def\jHTMLHinweisEingabeFunktionen{\MInputHint{%
\iFunctionInputHint{}}}

\def\jHTMLHinweisEingabeFunktionenSinCos{\MInputHint{%
\iSincosInputHint{}}}

\def\jHTMLHinweisEingabeFunktionenExp{\MInputHint{%
iExpInputHint{}}}

% ---------------------------------- Spezialbefehle fuer Fachbereich Physik --------------------------

\newcommand{\E}{{e}}
\newcommand{\ME}[1]{\cdot 10^{#1}}
\newcommand{\MU}[1]{\;\mathrm{#1}}
\newcommand{\MPG}[3]{%
  \ifnum#2=0%
    #1\ \mathrm{#3}%
  \else%
    #1\cdot 10^{#2}\ \mathrm{#3}%
  \fi}%
%

\newcommand{\MMul}{\MExponentensymbXYZl} % Nur eine Abkuerzung


% ---------------------------------- Stichwortfunktionialitaet ---------------------------------------

% mpreindexentry wird durch Auswahlroutine in conv.pl durch mindexentry substitutiert
\ifttm%
\def\MIndex#1{\index{#1}\special{html:<!-- mpreindexentry;;}#1\special{html:;;}\arabic{MSubjectArea}\special{html:;;}%
\arabic{chapter}\special{html:;;}\arabic{section}\special{html:;;}\arabic{subsection}\special{html:;;}\arabic{MEntryCounter}\special{html:; //-->}%
\setcounter{MLastIndex}{\value{MEntryCounter}}%
\addtocounter{MEntryCounter}{1}%
}%
% Copyrightliste wird als tex-Datei im preprocessing von conv.pl erzeugt und unter converter/tex/entrycollection.tex abgelegt
% Der input-Befehl funktioniert nur, wenn die aufrufende tex-Datei auf der obersten Ebene liegt (d.h. selbst kein input/include ist, insbesondere keine Moduldatei)
\def\MEntryList{} % \input funktioniert nicht, weil ttm (und damit das \input) ausgefuehrt wird, bevor Datei da ist
\else%
\def\MIndex#1{\index{#1}}
\def\MEntryList{\MAbort{Stichwortliste nur im HTML realisierbar}}%
\fi%

\def\MEntry#1#2{\textbf{#1}\MIndex{#2}} % Idee: MLastType auf neuen Entry-Typ und dann ein MLabel vergeben mit autogen-Nummer

% ---------------------------------- Befehle fuer Tests ----------------------------------------------

% MEquationItem stellt eine Eingabezeile der Form Vorgabe = Antwortfeld her, der zweite Parameter kann z.B. MSimplifyQuestion-Befehl sein
\ifttm
\newcommand{\MEquationItem}[2]{{#1}$\,=\,${#2}}%
\else%
\newcommand{\MEquationItem}[2]{{#1}$\;\;=\,${#2}}%
\fi

\ifttm
\newcommand{\MInputHint}[1]{%
\ifnum%
\if\value{MTestSite}>0%
\else%
\begin{html}<span class="text-info">\end{html}{#1}\begin{html}</span>\end{html}
\fi%
\fi%
}
\else
\newcommand{\MInputHint}[1]{\relax}
\fi

\ifttm
\newcommand{\MInTestHeader}{%
\iTest{}}
\else
\newcommand{\MInTestHeader}{%
\relax
}
\fi

\ifttm
\newcommand{\MInTestFooter}{%
\special{html:<button name="Name_TESTFINISH" id="TESTFINISH" type="button" onclick="finish_button('}\MTestName\special{html:');" class="testsbutton">}\iTestSubmit{}\special{html:</button>}%
\special{html:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<button name="Name_TESTRESET" id="TESTRESET" type="button" onclick="reset_button();" class="testsbutton">}\iTestReset{}\special{html:</button>
<br />
<br />
<div class="xreply">
<p name="Name_TESTEVAL" id="TESTEVAL">}
\iTestEval{}
\special{html:<br />
</p>
</div>}
}
\else
\newcommand{\MInTestFooter}{%
\relax
}
\fi


% ---------------------------------- Notationsmakros -------------------------------------------------------------

% Notationsmakros die nicht von der Kursvariante abhaengig sind

\ifttm%
\def\MTextSF#1{\textrm{#1}}% im HTML zerreisst ein font-Wechsel auf sans-serif die Zeilenhoehe
\else%
\def\MTextSF#1{\textsf{#1}}%
\fi%

\newcommand{\MZahltrennzeichen}[1]{\renewcommand{\MZXYZhltrennzeichen}{#1}}
\newcommand{\MGrad}{{}^{\circ}} % Fuer Winkel im Gradmass

\ifttm
\newcommand{\MZahl}[3][\MZXYZhltrennzeichen]{\edef\MZXYZtemp{\noexpand\special{html:<mn>#2#1#3</mn>}}\MZXYZtemp}
\else
\newcommand{\MZahl}[3][\MZXYZhltrennzeichen]{{}#2{#1}#3}
\fi

\newcommand{\MEinheitenabstand}[1]{\renewcommand{\MEinheitenabstXYZnd}{#1}}
\ifttm
\newcommand{\MEinheit}[2][\MEinheitenabstXYZnd]{{}#1\edef\MEINHtemp{\noexpand\special{html:<mi mathvariant="normal">#2</mi>}}\MEINHtemp}
\else
\newcommand{\MEinheit}[2][\MEinheitenabstXYZnd]{{}#1 \mathrm{#2}}
\fi

\newcommand{\MExponentensymbol}[1]{\renewcommand{\MExponentensymbXYZl}{#1}}
\newcommand{\MExponent}[2][\MExponentensymbXYZl]{{}#1{} 10^{#2}}

%Punkte in 2 und 3 Dimensionen
\newcommand{\MPointTwo}[3][]{#1(#2\MCoordPointSep #3{}#1)}
\newcommand{\MPointThree}[4][]{#1(#2\MCoordPointSep #3\MCoordPointSep #4{}#1)}
\newcommand{\MPointTwoAS}[2]{\left(#1\MCoordPointSep #2\right)}
\newcommand{\MPointThreeAS}[3]{\left(#1\MCoordPointSep #2\MCoordPointSep #3\right)}

% Masseinheit, Standardabstand: \,
\newcommand{\MEinheitenabstXYZnd}{\MThinspace}

% Horizontaler Leerraum zwischen herausgestellter Formel und Interpunktion
\ifttm
\newcommand{\MDFPSpace}{\,}
\newcommand{\MDFPaSpace}{\,\,}
\newcommand{\MBlank}{\ }
\else
\newcommand{\MDFPSpace}{\;}
\newcommand{\MDFPaSpace}{\;\;}
\newcommand{\MBlank}{\ }
\fi

% Satzende in herausgestellter Formel mit horizontalem Leerraum
\newcommand{\MDFPeriod}{\MDFPSpace .}

% Separation von Aufzaehlung und Bedingung in Menge
\newcommand{\MCondSetSep}{\,:\,} %oder '\mid'

% Konverter kennt mathopen nicht
\ifttm
\def\mathopen#1{}
\fi

% -----------------------------------START Rouletteaufgaben ------------------------------------------------------------

\ifttm
% #1 = Dateiname, #2 = eindeutige ID fuer das Roulette im Kurs
\newcommand{\MDirectRouletteExercises}[2]{
\begin{MExercise}
\texttt{Im HTML erscheinen hier Aufgaben aus einer Aufgabenliste...}
\end{MExercise}
}
\else
\newcommand{\MDirectRouletteExercises}[2]{\relax} % wird durch mconvert.pl gefunden und ersetzt
\fi


% ---------------------------------- START Makros, die von der Kursvariante abhaengen ----------------------------------

\ifvariantunotation
  % unotation = An Universitaeten uebliche Notation
  \def\MVariant{unotation}

  % Trennzeichen fuer Dezimalzahlen
  \newcommand{\MZXYZhltrennzeichen}{.}

  % Exponent zur Basis 10 in der Exponentialschreibweise,
  % Standardmalzeichen: \times
  \newcommand{\MExponentensymbXYZl}{\times}

  % Begrenzungszeichen fuer offene Intervalle
  \newcommand{\MoIl}[1][]{\mbox{}#1(\mathopen{}} % bzw. ']'
  \newcommand{\MoIr}[1][]{#1)\mbox{}} % bzw. '['

  % Zahlen-Separation im IntervaLL
  \newcommand{\MIntvlSep}{,} %oder ';'

  % Separation von Elementen in Mengen
  \newcommand{\MElSetSep}{,} %oder ';'

  % Separation von Koordinaten in Punkten
  \newcommand{\MCoordPointSep}{,} %oder ';' oder '|', '\MThinspace|\MThinspace'

\else
  % An dieser Stelle wird angenommen, dass std-Variante aktiv ist
  % std = beschlossene Notation im TU9-Onlinekurs
  \def\MVariant{std}

  % Trennzeichen fuer Dezimalzahlen
  \newcommand{\MZXYZhltrennzeichen}{.}

  % Exponent zur Basis 10 in der Exponentialschreibweise,
  % Standardmalzeichen: \times
  \newcommand{\MExponentensymbXYZl}{\times}

  % Begrenzungszeichen fuer offene Intervalle
  \newcommand{\MoIl}[1][]{\mbox{}#1]\mathopen{}} % bzw. '('
  \newcommand{\MoIr}[1][]{#1[\mbox{}} % bzw. ')'

  % Zahlen-Separation im IntervaLL
  \newcommand{\MIntvlSep}{;} %oder ','

  % Separation von Elementen in Mengen
  \newcommand{\MElSetSep}{;} %oder ','

  % Separation von Koordinaten in Punkten
  \newcommand{\MCoordPointSep}{;} %oder '|', '\MThinspace|\MThinspace'

\fi



% ---------------------------------- ENDE Makros, die von der Kursvariante abhaengen ----------------------------------


% diese Kommandos setzen Mathemodus vorraus
\newcommand{\MGeoAbstand}[2]{[\overline{{#1}{#2}}]}
\newcommand{\MGeoGerade}[2]{{#1}{#2}}
\newcommand{\MGeoStrecke}[2]{\overline{{#1}{#2}}}
\newcommand{\MGeoDreieck}[3]{{#1}{#2}{#3}}

%
\ifttm
\newcommand{\MOhm}{\special{html:<mn>&#x3A9;</mn>}}
\else
\newcommand{\MOhm}{\Omega} %\varOmega
\fi


\def\PERCTAG{\MAbort{PERCTAG ist zur internen verwendung in mconvert.pl reserviert, dieses Makro darf sonst nicht benutzt werden.}}

% Im Gegensatz zu einfachen html-Umgebungen werden MDirectHTML-Umgebungen von mconvert.pl am ganzen ttm-Prozess vorbeigeschleust und aus dem PDF komplett ausgeschnitten
\ifttm%
\newenvironment{MDirectHTML}{\begin{html}}{\end{html}}%
\else%
\newenvironment{MDirectHTML}{\begin{html}}{\end{html}}%
\fi

% Im Gegensatz zu einfachen Mathe-Umgebungen werden MDirectMath-Umgebungen von mconvert.pl am ganzen ttm-Prozess vorbeigeschleust, ueber MathJax realisiert, und im PDF als $$ ... $$ gesetzt
\ifttm%
\newenvironment{MDirectMath}{\begin{html}}{\end{html}}%
\else%
\newenvironment{MDirectMath}{\begin{equation*}}{\end{equation*}}% Vorsicht, auch \[ und \] werden in amsmath durch equation* redefiniert
\fi

% ---------------------------------- Location Management ---------------------------------------------

% #1 = buttonname (muss in files/images liegen und Format 48x48 haben), #2 = Vollstaendiger Einrichtungsname, #3 = Kuerzel der Einrichtung,  #4 = Name der include-texdatei
\ifttm
\newcommand{\MLocationSite}[3]{\special{html:<!-- mlocation;;}#1\special{html:;;}#2\special{html:;;}#3\special{html:;; //-->}}
\else
\newcommand{\MLocationSite}[3]{\relax}
\fi

% ---------------------------------- Copyright Management --------------------------------------------

\newcommand{\MCCLicense}{%
{\color{green}\textbf{CC BY-SA 3.0}}
}

\newcommand{\MCopyrightLabel}[1]{ (\MSRef{L_COPYRIGHTCOLLECTION}{Lizenz})\MLabel{#1}}
\newcommand{\MSilentCopyrightLabel}[1]{\MLabel{#1}} % label is added to tex code but not visible

% Copyrightliste wird als tex-Datei im preprocessing erzeugt und unter converter/tex/copyrightcollection.tex abgelegt
% Der input-Befehl funktioniert nur, wenn die aufrufende tex-Datei auf der obersten Ebene liegt (d.h. selbst kein input/include ist, insbesondere keine Moduldatei)
\newcommand{\MCopyrightCollection}{\input{copyrightcollection.tex}}

% MCopyrightNotice fuegt eine Copyrightnotiz ein, der parser ersetzt diese durch CopyrightNoticePOST im preparsing, diese Definition wird nur fuer reine pdflatex-Uebersetzungen gebraucht
% Parameter: #1: Kurze Lizenzbeschreibung (typischerweise \MCCLicense)
%            #2: Link zum Original (http://...) oder NONE falls das Bild selbst ein Original ist, oder TIKZ falls das Bild aus einer tikz-Umgebung stammt
%            #3: Link zum Autor (http://...) oder MINT falls Original im MINT-Kolleg erstellt oder NONE falls Autor unbekannt
%            #4: Bemerkung (z.B. dass Datei mit Maple exportiert wurde)
%            #5: Labelstring fuer existierendes Label auf das copyrighted Objekt, mit MCopyrightLabel erzeugt
%            Keines der Felder darf leer sein!
\newcommand{\MCopyrightNotice}[5]{\MCopyrightNoticePOST{#1}{#2}{#3}{#4}{#5}}

\ifttm%
\newcommand{\MCopyrightNoticePOST}[5]{\relax}%
\else%
\newcommand{\MCopyrightNoticePOST}[5]{\relax}%
\fi%

% ---------------------------------- Meldungen fuer den Benutzer des Konverters ----------------------
\MPragma{mintmodversion;P0.1.0}
\MPragma{usercomment;This is file mintmod.tex version P0.1.0}


% ----------------------------------- Spezialelemente fuer Konfigurationsseite, werden nicht von mintscripts.js verwaltet --

% #1 = DOM-id der Box
\ifttm\newcommand{\MConfigbox}[1]{\special{html:<input cfieldtype="2" type="checkbox" name="Name_}#1\special{html:" id="}#1\special{html:" onchange="confHandlerChange('}#1\special{html:');"/>}}\fi % darf im PDF nicht aufgerufen werden!
