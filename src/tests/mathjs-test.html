<!doctype html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
		<title>mathjs-Testeingaben</title>
		<script src="../files/qtip2/jquery-1.10.2.min.js" type="text/javascript"></script>
		<script src="../files/math.js" type="text/javascript"></script>
        <script type="text/javascript">
        //Global variables
        var isRelease = 0;
        var isVerbose = 1;
        </script>
		<script src="../files/dlog.js" type="text/javascript"></script>
		<script src="../files/mparser.js" type="text/javascript"></script>
		<script type="text/javascript">

			/*
			 * Liste aller Testeingaben und der erwarteten Ergebnisse
			 * input: Testeingabe
			 * result: Erwartetes Ergebnis
			 * */
			var testEingaben = [
				//manuelle Tests
				{ input: "0", result: 0 },
				{ input: "0", result: 0 },
				{ input: "konstrukt(int,x,0,0,(stuetzvariable_x),1000)", result: 0 },
				{ input: "konstrukt(int,x,0,1,(stuetzvariable_x),1000)", result: 0.5 },
				{ input: "konstrukt(int,x,0,2,(stuetzvariable_x),1000)", result: 2 },
				{ input: "konstrukt(int,x,0,1,(stuetzvariable_x)^2,1000)", result: 1/3 },
				{ input: "konstrukt(int,x,0,2,(stuetzvariable_x)^2,1000)", result: 8/3 },
				{ input: "konstrukt(int,x,0,2*pi,sin((stuetzvariable_x)), 1000)", result: 0 },
				{ input: "konstrukt(sum,alpha,1,1,(stuetzvariable_alpha))", result: 1 },
				{ input: "konstrukt(sum,alpha,1,100,(stuetzvariable_alpha))", result: 5050 },
				{ input: "konstrukt(sum,n,100,100,(stuetzvariable_n))", result: 100 },
				{ input: "sqrt(konstrukt(sum,n,1,1000,(1/(stuetzvariable_n)^2))*6)", result: Math.PI },
				{ input: "factorial(6)", result: 720 },
				{ input: "binomial(6,6)", result: 1 },
				{ input: "binomial(6,5)", result: 6 },
				{ input: "binomial(49,6)", result: 13983816 },

				{ input: "ln(e)", result: 1 }
			];
			function teste() {
				var container = document.getElementById("container");
				var epsilon = document.getElementById("epsilon").value;
				var ergebnisTabelle = 
						"<table border=1>"
					+	"	<tr>"
					+	"		<td><b>Eingabe</b></td>"
					+	"		<td><b>Ergebnis</b></td>"
					+	"		<td><b>Erwartung</b></td>"
					+	"		<td><b>Abweichung</b></td>"
				//Gehe alle Testdaten durch
				testEingaben.forEach( 
						function (value) {
							var ergebnis = mparser.evalMathJS( value.input );
							var difference = Math.abs( ergebnis - value.result );

							var ergebnisColor = "red";
							//Teste Ergebnis auf Übereinstimmung
							if( difference <= epsilon ) {
								ergebnisColor = "lightgreen";
							} else if( (typeof value.result == "undefined") || (value.result === "")) {
								ergebnisColor = "orange";
							}

							ergebnisTabelle +=
									"<tr>"
								+	"	<td>" + value.input + "</td>"
								+	"	<td style='background-color:" + ergebnisColor + ";'>" + ergebnis + "</td>"
								+	"	<td>" + value.result + "</td>"
								+	"	<td>" + difference + "</td>"
								+	"</tr>";
						});

				ergebnisTabelle += "</table>";
				container.innerHTML = ergebnisTabelle;
			}
		</script>
	</head>
	<body onload="teste();">
		<h1>Tests:</h1>
		<ul>
			<li><b style="background-color:lightgreen;">Grün:</b> Ergebnis korrekt</li>
			<li><b style="background-color:red;">Rot:</b> Ergebnis inkorrekt</li>
			<li><b style="background-color:orange;">Orange:</b> Korrektes Ergebnis noch nicht festgelegt</li>
		</ul>
		<b>Maximale Abweichung:</b>
		<input type="text" value="0.001" id="epsilon" onkeydown="if(event.keyCode == 13) teste();">
		<input type="button" onclick="teste();" value="Test durchführen">
		<br/>
		<div id="container">
			Es ist ein Fehler aufgetreten!
		</div>
	</body>
</html>
